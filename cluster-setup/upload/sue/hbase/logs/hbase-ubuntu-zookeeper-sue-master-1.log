Tue Jan 17 19:13:48 UTC 2017 Starting zookeeper on sue-master-1
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 514644
max locked memory       (kbytes, -l) 64
max memory size         (kbytes, -m) unlimited
open files                      (-n) 1024
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) unlimited
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited
2017-01-17 19:13:49,167 WARN  [main] quorum.QuorumPeerConfig: Non-optimial configuration, consider an odd number of servers.
2017-01-17 19:13:49,167 INFO  [main] quorum.QuorumPeerConfig: Defaulting to majority quorums
2017-01-17 19:13:49,252 DEBUG [main] util.Bytes: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.util.Bytes
2017-01-17 19:13:49,253 DEBUG [main] util.VersionInfo: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.util.VersionInfo
2017-01-17 19:13:49,253 DEBUG [main] zookeeper.ZKConfig: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.zookeeper.ZKConfig
2017-01-17 19:13:49,254 DEBUG [main] hbase.HBaseConfiguration: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.HBaseConfiguration
2017-01-17 19:13:49,254 DEBUG [main] hadoop.hbase: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase
2017-01-17 19:13:49,254 INFO  [main] quorum.QuorumPeerMain: Starting quorum peer
2017-01-17 19:13:49,261 INFO  [main] server.NIOServerCnxnFactory: binding to port 0.0.0.0/0.0.0.0:2181
2017-01-17 19:13:49,272 INFO  [main] quorum.QuorumPeer: tickTime set to 3000
2017-01-17 19:13:49,272 INFO  [main] quorum.QuorumPeer: minSessionTimeout set to -1
2017-01-17 19:13:49,273 INFO  [main] quorum.QuorumPeer: maxSessionTimeout set to 90000
2017-01-17 19:13:49,273 INFO  [main] quorum.QuorumPeer: initLimit set to 10
2017-01-17 19:13:49,291 INFO  [main] quorum.QuorumPeer: currentEpoch not found! Creating with a reasonable default of 0. This should only happen when you are upgrading your installation
2017-01-17 19:13:49,292 INFO  [main] quorum.QuorumPeer: acceptedEpoch not found! Creating with a reasonable default of 0. This should only happen when you are upgrading your installation
2017-01-17 19:13:49,296 INFO  [Thread-1] quorum.QuorumCnxManager: My election bind port: 0.0.0.0/0.0.0.0:3888
2017-01-17 19:13:49,304 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: LOOKING
2017-01-17 19:13:49,305 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: New election. My id =  0, proposed zxid=0x0
2017-01-17 19:13:49,307 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 0 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-17 19:13:49,311 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (1, 0)
2017-01-17 19:13:49,311 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.157:44754
2017-01-17 19:13:49,314 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (2, 0)
2017-01-17 19:13:49,314 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (3, 0)
2017-01-17 19:13:49,315 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.148:55702
2017-01-17 19:13:49,315 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (4, 0)
2017-01-17 19:13:49,319 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (5, 0)
2017-01-17 19:13:49,319 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 1 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-17 19:13:49,319 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.151:37834
2017-01-17 19:13:49,320 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.150:36564
2017-01-17 19:13:49,322 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.149:38056
2017-01-17 19:13:49,322 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 2 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-17 19:13:49,322 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 3 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-17 19:13:49,322 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 4 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-17 19:13:49,323 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 0 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-17 19:13:49,324 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 5 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-17 19:13:49,525 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: FOLLOWING
2017-01-17 19:13:49,531 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: TCP NoDelay set to: true
2017-01-17 19:13:49,543 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:zookeeper.version=3.4.5--1, built on 10/05/2013 16:05 GMT
2017-01-17 19:13:49,543 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:host.name=sue-master-1
2017-01-17 19:13:49,543 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.version=1.8.0_111
2017-01-17 19:13:49,543 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.vendor=Oracle Corporation
2017-01-17 19:13:49,543 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.home=/usr/lib/jvm/java-8-openjdk-amd64/jre
2017-01-17 19:13:49,543 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.class.path=/usr/local/hbase/bin/../conf:/usr/lib/jvm/java-8-openjdk-amd64/jre//lib/tools.jar:/usr/local/hbase/bin/..:/usr/local/hbase/bin/../lib/activation-1.1.jar:/usr/local/hbase/bin/../lib/asm-3.1.jar:/usr/local/hbase/bin/../lib/commons-beanutils-1.7.0.jar:/usr/local/hbase/bin/../lib/commons-beanutils-core-1.8.0.jar:/usr/local/hbase/bin/../lib/commons-cli-1.2.jar:/usr/local/hbase/bin/../lib/commons-codec-1.7.jar:/usr/local/hbase/bin/../lib/commons-collections-3.2.1.jar:/usr/local/hbase/bin/../lib/commons-configuration-1.6.jar:/usr/local/hbase/bin/../lib/commons-digester-1.8.jar:/usr/local/hbase/bin/../lib/commons-el-1.0.jar:/usr/local/hbase/bin/../lib/commons-httpclient-3.1.jar:/usr/local/hbase/bin/../lib/commons-io-2.4.jar:/usr/local/hbase/bin/../lib/commons-lang-2.6.jar:/usr/local/hbase/bin/../lib/commons-logging-1.1.1.jar:/usr/local/hbase/bin/../lib/commons-math-2.2.jar:/usr/local/hbase/bin/../lib/commons-net-1.4.1.jar:/usr/local/hbase/bin/../lib/core-3.1.1.jar:/usr/local/hbase/bin/../lib/findbugs-annotations-1.3.9-1.jar:/usr/local/hbase/bin/../lib/guava-12.0.1.jar:/usr/local/hbase/bin/../lib/hadoop-core-1.2.1.jar:/usr/local/hbase/bin/../lib/hamcrest-core-1.3.jar:/usr/local/hbase/bin/../lib/hbase-client-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-common-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-common-0.98.0-hadoop1-tests.jar:/usr/local/hbase/bin/../lib/hbase-examples-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-hadoop1-compat-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-hadoop-compat-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-it-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-it-0.98.0-hadoop1-tests.jar:/usr/local/hbase/bin/../lib/hbase-prefix-tree-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-protocol-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-server-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-server-0.98.0-hadoop1-tests.jar:/usr/local/hbase/bin/../lib/hbase-shell-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-testing-util-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-thrift-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/high-scale-lib-1.1.1.jar:/usr/local/hbase/bin/../lib/htrace-core-2.04.jar:/usr/local/hbase/bin/../lib/httpclient-4.1.3.jar:/usr/local/hbase/bin/../lib/httpcore-4.1.3.jar:/usr/local/hbase/bin/../lib/jackson-core-asl-1.8.8.jar:/usr/local/hbase/bin/../lib/jackson-jaxrs-1.8.8.jar:/usr/local/hbase/bin/../lib/jackson-mapper-asl-1.8.8.jar:/usr/local/hbase/bin/../lib/jackson-xc-1.8.8.jar:/usr/local/hbase/bin/../lib/jamon-runtime-2.3.1.jar:/usr/local/hbase/bin/../lib/jasper-compiler-5.5.23.jar:/usr/local/hbase/bin/../lib/jasper-runtime-5.5.23.jar:/usr/local/hbase/bin/../lib/jaxb-api-2.2.2.jar:/usr/local/hbase/bin/../lib/jaxb-impl-2.2.3-1.jar:/usr/local/hbase/bin/../lib/jersey-core-1.8.jar:/usr/local/hbase/bin/../lib/jersey-json-1.8.jar:/usr/local/hbase/bin/../lib/jersey-server-1.8.jar:/usr/local/hbase/bin/../lib/jettison-1.3.1.jar:/usr/local/hbase/bin/../lib/jetty-6.1.26.jar:/usr/local/hbase/bin/../lib/jetty-sslengine-6.1.26.jar:/usr/local/hbase/bin/../lib/jetty-util-6.1.26.jar:/usr/local/hbase/bin/../lib/jruby-complete-1.6.8.jar:/usr/local/hbase/bin/../lib/jsp-2.1-6.1.14.jar:/usr/local/hbase/bin/../lib/jsp-api-2.1-6.1.14.jar:/usr/local/hbase/bin/../lib/jsr305-1.3.9.jar:/usr/local/hbase/bin/../lib/junit-4.11.jar:/usr/local/hbase/bin/../lib/libthrift-0.9.0.jar:/usr/local/hbase/bin/../lib/log4j-1.2.17.jar:/usr/local/hbase/bin/../lib/metrics-core-2.1.2.jar:/usr/local/hbase/bin/../lib/netty-3.6.6.Final.jar:/usr/local/hbase/bin/../lib/protobuf-java-2.5.0.jar:/usr/local/hbase/bin/../lib/servlet-api-2.5-6.1.14.jar:/usr/local/hbase/bin/../lib/slf4j-api-1.6.4.jar:/usr/local/hbase/bin/../lib/slf4j-log4j12-1.6.4.jar:/usr/local/hbase/bin/../lib/stax-api-1.0.1.jar:/usr/local/hbase/bin/../lib/xmlenc-0.52.jar:/usr/local/hbase/bin/../lib/zookeeper-3.4.5.jar:
2017-01-17 19:13:49,543 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.library.path=/usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2017-01-17 19:13:49,543 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.io.tmpdir=/tmp
2017-01-17 19:13:49,543 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.compiler=<NA>
2017-01-17 19:13:49,544 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:os.name=Linux
2017-01-17 19:13:49,544 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:os.arch=amd64
2017-01-17 19:13:49,544 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:os.version=4.4.0-53-generic
2017-01-17 19:13:49,544 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:user.name=ubuntu
2017-01-17 19:13:49,544 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:user.home=/home/ubuntu
2017-01-17 19:13:49,544 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:user.dir=/usr/local/hbase
2017-01-17 19:13:49,545 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 90000 datadir /home/ubuntu/zookeeper/version-2 snapdir /home/ubuntu/zookeeper/version-2
2017-01-17 19:13:49,546 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: FOLLOWING - LEADER ELECTION TOOK - 241
2017-01-17 19:13:50,556 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Getting a diff from the leader 0x0
2017-01-17 19:13:50,561 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileTxnSnapLog: Snapshotting: 0x0 to /home/ubuntu/zookeeper/version-2/snapshot.0
2017-01-17 19:13:50,568 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileTxnSnapLog: Snapshotting: 0x0 to /home/ubuntu/zookeeper/version-2/snapshot.0
2017-01-17 19:13:50,940 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Got zxid 0x100000001 expected 0x1
2017-01-17 19:13:50,940 INFO  [SyncThread:0] persistence.FileTxnLog: Creating new log file: log.100000001
2017-01-17 19:13:53,034 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.150:49996
2017-01-17 19:13:53,125 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to establish new session at /172.24.43.150:49996
2017-01-17 19:13:53,132 INFO  [CommitProcessor:0] server.ZooKeeperServer: Established session 0x59add983e00000 with negotiated timeout 90000 for client /172.24.43.150:49996
2017-01-17 19:13:53,808 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.150:50004
2017-01-17 19:13:53,808 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to establish new session at /172.24.43.150:50004
2017-01-17 19:13:53,827 INFO  [CommitProcessor:0] server.ZooKeeperServer: Established session 0x59add983e00001 with negotiated timeout 90000 for client /172.24.43.150:50004
2017-01-18 10:45:06,334 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.148:51198
2017-01-18 10:45:06,335 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.151:48880
2017-01-18 10:45:06,335 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to renew session 0x259add983e00001 at /172.24.43.148:51198
2017-01-18 10:45:06,335 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] quorum.Learner: Revalidating client: 0x259add983e00001
2017-01-18 10:45:06,335 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to renew session 0x259add983e00000 at /172.24.43.151:48880
2017-01-18 10:45:06,335 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] quorum.Learner: Revalidating client: 0x259add983e00000
2017-01-18 10:45:06,336 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:52174
2017-01-18 10:45:06,336 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to renew session 0x459add983e40000 at /172.24.43.157:52174
2017-01-18 10:45:06,336 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] quorum.Learner: Revalidating client: 0x459add983e40000
2017-01-18 10:45:06,338 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 3 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:45:06,338 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Exception when following the leader
java.net.SocketException: Broken pipe (Write failed)
	at java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:109)
	at java.net.SocketOutputStream.write(SocketOutputStream.java:153)
	at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:82)
	at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:140)
	at org.apache.zookeeper.server.quorum.Learner.writePacket(Learner.java:138)
	at org.apache.zookeeper.server.quorum.Learner.ping(Learner.java:465)
	at org.apache.zookeeper.server.quorum.Follower.processPacket(Follower.java:112)
	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:86)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:740)
2017-01-18 10:45:06,341 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: shutdown called
java.lang.Exception: shutdown Follower
	at org.apache.zookeeper.server.quorum.Follower.shutdown(Follower.java:166)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:744)
2017-01-18 10:45:06,342 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.150:49996 which had sessionid 0x59add983e00000
2017-01-18 10:45:06,345 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.150:50004 which had sessionid 0x59add983e00001
2017-01-18 10:45:06,346 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.157:52174 which had sessionid 0x459add983e40000
2017-01-18 10:45:06,346 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.151:48880 which had sessionid 0x259add983e00000
2017-01-18 10:45:06,346 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.148:51198 which had sessionid 0x259add983e00001
2017-01-18 10:45:06,347 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FollowerZooKeeperServer: Shutting down
2017-01-18 10:45:06,351 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: shutting down
2017-01-18 10:45:06,351 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FollowerRequestProcessor: Shutting down
2017-01-18 10:45:06,351 INFO  [FollowerRequestProcessor:0] quorum.FollowerRequestProcessor: FollowerRequestProcessor exited loop!
2017-01-18 10:45:06,352 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.CommitProcessor: Shutting down
2017-01-18 10:45:06,338 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 3 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:45:06,356 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 3 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:45:06,356 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 3 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:45:06,356 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 3 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:45:06,356 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 2 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:45:06,356 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 2 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:45:06,356 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 2 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:45:06,357 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 2 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:45:06,357 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 2 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:45:06,357 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 2 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:45:06,357 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 2 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:45:06,357 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 1 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:45:06,357 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 1 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:45:06,357 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 1 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:45:06,357 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 1 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:45:06,357 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 1 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:45:06,362 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.FinalRequestProcessor: shutdown of request processor complete
2017-01-18 10:45:06,362 INFO  [CommitProcessor:0] quorum.CommitProcessor: CommitProcessor exited loop!
2017-01-18 10:45:06,363 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.SyncRequestProcessor: Shutting down
2017-01-18 10:45:06,363 INFO  [SyncThread:0] server.SyncRequestProcessor: SyncRequestProcessor exited!
2017-01-18 10:45:06,363 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: LOOKING
2017-01-18 10:45:06,365 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileSnap: Reading snapshot /home/ubuntu/zookeeper/version-2/snapshot.0
2017-01-18 10:45:06,372 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: New election. My id =  0, proposed zxid=0x100000050
2017-01-18 10:45:06,380 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:06,585 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: Notification time out: 400
2017-01-18 10:45:06,586 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:06,986 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: Notification time out: 800
2017-01-18 10:45:06,987 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:07,788 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: Notification time out: 1600
2017-01-18 10:45:07,789 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:09,389 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: Notification time out: 3200
2017-01-18 10:45:09,390 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:12,591 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: Notification time out: 6400
2017-01-18 10:45:12,592 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:12,593 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 1 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:12,594 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 1 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:15,795 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:52186
2017-01-18 10:45:15,796 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:45:15,796 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.157:52186 (no session established for client)
2017-01-18 10:45:18,994 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: Notification time out: 12800
2017-01-18 10:45:18,995 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 1 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:18,996 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 1 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:22,138 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.156:53430
2017-01-18 10:45:22,138 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:45:22,139 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.156:53430 (no session established for client)
2017-01-18 10:45:31,796 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: Notification time out: 25600
2017-01-18 10:45:31,797 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 1 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:31,797 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 1 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:32,009 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:52208
2017-01-18 10:45:32,010 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:45:32,010 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.157:52208 (no session established for client)
2017-01-18 10:45:37,290 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LEADING (n.state), 5 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:37,345 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 5 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:37,346 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:37,347 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:37,548 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 5 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:37,950 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 5 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:38,750 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 5 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:40,352 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 5 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:43,553 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 5 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:43,650 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), FOLLOWING (n.state), 4 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:43,696 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 4 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:43,897 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 4 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:44,298 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 4 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:44,524 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:52222
2017-01-18 10:45:44,525 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:45:44,525 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.157:52222 (no session established for client)
2017-01-18 10:45:44,580 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.150:39774
2017-01-18 10:45:44,581 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:45:44,581 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.150:39774 (no session established for client)
2017-01-18 10:45:45,099 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 4 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:46,702 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 4 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:49,903 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 4 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:50,724 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 3 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:50,725 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 4 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:45:50,926 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: FOLLOWING
2017-01-18 10:45:50,926 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 90000 datadir /home/ubuntu/zookeeper/version-2 snapdir /home/ubuntu/zookeeper/version-2
2017-01-18 10:45:50,926 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: FOLLOWING - LEADER ELECTION TOOK - 44563
2017-01-18 10:45:51,763 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Getting a diff from the leader 0x100000050
2017-01-18 10:45:51,765 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileTxnSnapLog: Snapshotting: 0x100000050 to /home/ubuntu/zookeeper/version-2/snapshot.100000050
2017-01-18 10:45:51,770 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileTxnSnapLog: Snapshotting: 0x100000050 to /home/ubuntu/zookeeper/version-2/snapshot.100000050
2017-01-18 10:45:52,298 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.149:37410
2017-01-18 10:45:52,298 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to renew session 0x159add983dc0002 at /172.24.43.149:37410
2017-01-18 10:45:52,298 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] quorum.Learner: Revalidating client: 0x159add983dc0002
2017-01-18 10:45:52,301 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Established session 0x159add983dc0002 with negotiated timeout 90000 for client /172.24.43.149:37410
2017-01-18 10:45:54,755 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.149:37424
2017-01-18 10:45:54,756 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to renew session 0x159add983dc0003 at /172.24.43.149:37424
2017-01-18 10:45:54,756 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] quorum.Learner: Revalidating client: 0x159add983dc0003
2017-01-18 10:45:54,758 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Established session 0x159add983dc0003 with negotiated timeout 90000 for client /172.24.43.149:37424
2017-01-18 10:45:56,365 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 2 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:45:56,545 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.156:53474
2017-01-18 10:45:56,546 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to renew session 0x159add983dc0004 at /172.24.43.156:53474
2017-01-18 10:45:56,546 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] quorum.Learner: Revalidating client: 0x159add983dc0004
2017-01-18 10:45:56,548 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Established session 0x159add983dc0004 with negotiated timeout 90000 for client /172.24.43.156:53474
2017-01-18 10:45:57,604 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.151:56966
2017-01-18 10:45:57,604 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to renew session 0x159add983dc0005 at /172.24.43.151:56966
2017-01-18 10:45:57,604 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] quorum.Learner: Revalidating client: 0x159add983dc0005
2017-01-18 10:45:57,606 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Established session 0x159add983dc0005 with negotiated timeout 90000 for client /172.24.43.151:56966
2017-01-18 10:45:57,884 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.148:59530
2017-01-18 10:45:57,885 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to renew session 0x259add983e00003 at /172.24.43.148:59530
2017-01-18 10:45:57,885 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] quorum.Learner: Revalidating client: 0x259add983e00003
2017-01-18 10:45:57,886 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Established session 0x259add983e00003 with negotiated timeout 90000 for client /172.24.43.148:59530
2017-01-18 10:46:02,770 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 4 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:53:15,043 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: caught end of stream exception
EndOfStreamException: Unable to read additional data from client sessionid 0x159add983dc0002, likely client has closed socket
	at org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:220)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:208)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:15,044 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.149:37410 which had sessionid 0x159add983dc0002
2017-01-18 10:53:15,044 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: caught end of stream exception
EndOfStreamException: Unable to read additional data from client sessionid 0x159add983dc0003, likely client has closed socket
	at org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:220)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:208)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:15,046 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Exception when following the leader
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)
	at org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:83)
	at org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:108)
	at org.apache.zookeeper.server.quorum.Learner.readPacket(Learner.java:152)
	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:85)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:740)
2017-01-18 10:53:15,047 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: shutdown called
java.lang.Exception: shutdown Follower
	at org.apache.zookeeper.server.quorum.Follower.shutdown(Follower.java:166)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:744)
2017-01-18 10:53:15,048 WARN  [RecvWorker:5] quorum.QuorumCnxManager: Connection broken for id 5, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 10:53:15,048 WARN  [RecvWorker:5] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 10:53:15,049 WARN  [SendWorker:5] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 10:53:15,049 WARN  [SendWorker:5] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 10:53:15,050 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.149:37424 which had sessionid 0x159add983dc0003
2017-01-18 10:53:15,052 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x3 (n.round), LOOKING (n.state), 4 (n.sid), 0x2 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:53:15,052 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.156:53474 which had sessionid 0x159add983dc0004
2017-01-18 10:53:15,053 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.148:59530 which had sessionid 0x259add983e00003
2017-01-18 10:53:15,053 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.151:56966 which had sessionid 0x159add983dc0005
2017-01-18 10:53:15,053 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FollowerZooKeeperServer: Shutting down
2017-01-18 10:53:15,053 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: shutting down
2017-01-18 10:53:15,053 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FollowerRequestProcessor: Shutting down
2017-01-18 10:53:15,054 INFO  [FollowerRequestProcessor:0] quorum.FollowerRequestProcessor: FollowerRequestProcessor exited loop!
2017-01-18 10:53:15,054 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 1 (n.leader), 0x100000050 (n.zxid), 0x3 (n.round), LOOKING (n.state), 1 (n.sid), 0x2 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:53:15,055 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.CommitProcessor: Shutting down
2017-01-18 10:53:15,055 INFO  [CommitProcessor:0] quorum.CommitProcessor: CommitProcessor exited loop!
2017-01-18 10:53:15,055 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 3 (n.sid), 0x2 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:53:15,055 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.FinalRequestProcessor: shutdown of request processor complete
2017-01-18 10:53:15,056 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.SyncRequestProcessor: Shutting down
2017-01-18 10:53:15,056 INFO  [SyncThread:0] server.SyncRequestProcessor: SyncRequestProcessor exited!
2017-01-18 10:53:15,056 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: LOOKING
2017-01-18 10:53:15,057 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x3 (n.round), LOOKING (n.state), 3 (n.sid), 0x2 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:15,057 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x3 (n.round), LOOKING (n.state), 1 (n.sid), 0x2 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:15,057 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileSnap: Reading snapshot /home/ubuntu/zookeeper/version-2/snapshot.100000050
2017-01-18 10:53:15,060 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: New election. My id =  0, proposed zxid=0x100000050
2017-01-18 10:53:15,060 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x100000050 (n.zxid), 0x3 (n.round), LOOKING (n.state), 0 (n.sid), 0x2 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:15,063 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:15,064 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x3 (n.round), LOOKING (n.state), 0 (n.sid), 0x2 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:15,064 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:15,067 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x100000050 (n.zxid), 0x3 (n.round), LOOKING (n.state), 2 (n.sid), 0x2 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:15,069 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x3 (n.round), LOOKING (n.state), 2 (n.sid), 0x2 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:15,270 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: FOLLOWING
2017-01-18 10:53:15,270 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 90000 datadir /home/ubuntu/zookeeper/version-2 snapdir /home/ubuntu/zookeeper/version-2
2017-01-18 10:53:15,270 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: FOLLOWING - LEADER ELECTION TOOK - 214
2017-01-18 10:53:15,271 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Unexpected exception, tries=0, connecting to sue-data-3/172.24.43.150:2888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.Learner.connectToLeader(Learner.java:224)
	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:71)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:740)
2017-01-18 10:53:15,282 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.148:59632
2017-01-18 10:53:15,283 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:53:15,283 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.148:59632 (no session established for client)
2017-01-18 10:53:15,368 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.151:57066
2017-01-18 10:53:15,369 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:53:15,369 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.151:57066 (no session established for client)
2017-01-18 10:53:15,531 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.150:39990
2017-01-18 10:53:15,531 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:53:15,531 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.150:39990 (no session established for client)
2017-01-18 10:53:15,699 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:52334
2017-01-18 10:53:15,699 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:53:15,700 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.157:52334 (no session established for client)
2017-01-18 10:53:15,775 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.150:39992
2017-01-18 10:53:15,775 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:53:15,775 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.150:39992 (no session established for client)
2017-01-18 10:53:16,255 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.150:39998
2017-01-18 10:53:16,255 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:53:16,255 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.150:39998 (no session established for client)
2017-01-18 10:53:16,290 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Getting a diff from the leader 0x100000050
2017-01-18 10:53:16,310 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileTxnSnapLog: Snapshotting: 0x100000050 to /home/ubuntu/zookeeper/version-2/snapshot.100000050
2017-01-18 10:53:16,315 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileTxnSnapLog: Snapshotting: 0x100000050 to /home/ubuntu/zookeeper/version-2/snapshot.100000050
2017-01-18 10:53:16,634 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:52350
2017-01-18 10:53:16,634 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to renew session 0x159add983dc0000 at /172.24.43.157:52350
2017-01-18 10:53:16,634 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] quorum.Learner: Revalidating client: 0x159add983dc0000
2017-01-18 10:53:16,636 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Established session 0x159add983dc0000 with negotiated timeout 90000 for client /172.24.43.157:52350
2017-01-18 10:53:16,681 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Exception when following the leader
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)
	at org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:83)
	at org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:108)
	at org.apache.zookeeper.server.quorum.Learner.readPacket(Learner.java:152)
	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:85)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:740)
2017-01-18 10:53:16,682 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: shutdown called
java.lang.Exception: shutdown Follower
	at org.apache.zookeeper.server.quorum.Follower.shutdown(Follower.java:166)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:744)
2017-01-18 10:53:16,682 WARN  [RecvWorker:4] quorum.QuorumCnxManager: Connection broken for id 4, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 10:53:16,682 WARN  [RecvWorker:4] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 10:53:16,683 WARN  [SendWorker:4] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 10:53:16,683 WARN  [SendWorker:4] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 10:53:16,691 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.157:52350 which had sessionid 0x159add983dc0000
2017-01-18 10:53:16,691 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FollowerZooKeeperServer: Shutting down
2017-01-18 10:53:16,691 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: shutting down
2017-01-18 10:53:16,691 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FollowerRequestProcessor: Shutting down
2017-01-18 10:53:16,691 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.CommitProcessor: Shutting down
2017-01-18 10:53:16,691 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.FinalRequestProcessor: shutdown of request processor complete
2017-01-18 10:53:16,691 INFO  [CommitProcessor:0] quorum.CommitProcessor: CommitProcessor exited loop!
2017-01-18 10:53:16,691 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.SyncRequestProcessor: Shutting down
2017-01-18 10:53:16,692 INFO  [SyncThread:0] server.SyncRequestProcessor: SyncRequestProcessor exited!
2017-01-18 10:53:16,692 INFO  [FollowerRequestProcessor:0] quorum.FollowerRequestProcessor: FollowerRequestProcessor exited loop!
2017-01-18 10:53:16,692 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 1 (n.leader), 0x100000050 (n.zxid), 0x4 (n.round), LOOKING (n.state), 1 (n.sid), 0x3 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:16,692 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x100000050 (n.zxid), 0x4 (n.round), LOOKING (n.state), 2 (n.sid), 0x3 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:16,692 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: LOOKING
2017-01-18 10:53:16,693 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileSnap: Reading snapshot /home/ubuntu/zookeeper/version-2/snapshot.100000050
2017-01-18 10:53:16,697 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x100000050 (n.zxid), 0x4 (n.round), LOOKING (n.state), 1 (n.sid), 0x3 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:16,697 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x4 (n.round), LOOKING (n.state), 3 (n.sid), 0x3 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:16,699 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x4 (n.round), LOOKING (n.state), 1 (n.sid), 0x3 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:16,700 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: New election. My id =  0, proposed zxid=0x100000050
2017-01-18 10:53:16,700 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x100000050 (n.zxid), 0x4 (n.round), LOOKING (n.state), 0 (n.sid), 0x3 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:16,701 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 4 at election address sue-data-3/172.24.43.150:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:16,705 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x4 (n.round), LOOKING (n.state), 2 (n.sid), 0x3 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:16,705 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:16,715 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 1 (n.leader), 0x100000050 (n.zxid), 0x4 (n.round), LOOKING (n.state), 0 (n.sid), 0x3 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:16,716 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 4 at election address sue-data-3/172.24.43.150:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:16,716 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:16,717 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x100000050 (n.zxid), 0x4 (n.round), LOOKING (n.state), 0 (n.sid), 0x3 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:16,717 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 4 at election address sue-data-3/172.24.43.150:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:16,719 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:16,719 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x4 (n.round), LOOKING (n.state), 0 (n.sid), 0x3 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:16,729 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 4 at election address sue-data-3/172.24.43.150:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:16,729 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:16,905 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.151:57112
2017-01-18 10:53:16,906 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:53:16,906 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.151:57112 (no session established for client)
2017-01-18 10:53:16,929 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: FOLLOWING
2017-01-18 10:53:16,930 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 90000 datadir /home/ubuntu/zookeeper/version-2 snapdir /home/ubuntu/zookeeper/version-2
2017-01-18 10:53:16,930 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: FOLLOWING - LEADER ELECTION TOOK - 237
2017-01-18 10:53:17,137 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:52368
2017-01-18 10:53:17,137 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:53:17,137 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.157:52368 (no session established for client)
2017-01-18 10:53:17,384 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.151:57126
2017-01-18 10:53:17,384 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:53:17,384 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.151:57126 (no session established for client)
2017-01-18 10:53:17,944 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Getting a diff from the leader 0x100000050
2017-01-18 10:53:17,953 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileTxnSnapLog: Snapshotting: 0x100000050 to /home/ubuntu/zookeeper/version-2/snapshot.100000050
2017-01-18 10:53:17,955 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileTxnSnapLog: Snapshotting: 0x100000050 to /home/ubuntu/zookeeper/version-2/snapshot.100000050
2017-01-18 10:53:18,218 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.148:59674
2017-01-18 10:53:18,224 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to renew session 0x459add983e40001 at /172.24.43.148:59674
2017-01-18 10:53:18,224 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] quorum.Learner: Revalidating client: 0x459add983e40001
2017-01-18 10:53:18,227 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Established session 0x459add983e40001 with negotiated timeout 90000 for client /172.24.43.148:59674
2017-01-18 10:53:18,271 WARN  [RecvWorker:3] quorum.QuorumCnxManager: Connection broken for id 3, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 10:53:18,271 WARN  [RecvWorker:3] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 10:53:18,271 WARN  [SendWorker:3] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 10:53:18,272 WARN  [SendWorker:3] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 10:53:18,272 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Exception when following the leader
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)
	at org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:83)
	at org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:108)
	at org.apache.zookeeper.server.quorum.Learner.readPacket(Learner.java:152)
	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:85)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:740)
2017-01-18 10:53:18,272 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: shutdown called
java.lang.Exception: shutdown Follower
	at org.apache.zookeeper.server.quorum.Follower.shutdown(Follower.java:166)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:744)
2017-01-18 10:53:18,272 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.148:59674 which had sessionid 0x459add983e40001
2017-01-18 10:53:18,275 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FollowerZooKeeperServer: Shutting down
2017-01-18 10:53:18,275 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: shutting down
2017-01-18 10:53:18,275 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FollowerRequestProcessor: Shutting down
2017-01-18 10:53:18,275 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.CommitProcessor: Shutting down
2017-01-18 10:53:18,275 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.FinalRequestProcessor: shutdown of request processor complete
2017-01-18 10:53:18,275 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.SyncRequestProcessor: Shutting down
2017-01-18 10:53:18,276 INFO  [CommitProcessor:0] quorum.CommitProcessor: CommitProcessor exited loop!
2017-01-18 10:53:18,276 INFO  [FollowerRequestProcessor:0] quorum.FollowerRequestProcessor: FollowerRequestProcessor exited loop!
2017-01-18 10:53:18,276 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 1 (n.leader), 0x100000050 (n.zxid), 0x5 (n.round), LOOKING (n.state), 1 (n.sid), 0x4 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:53:18,277 INFO  [SyncThread:0] server.SyncRequestProcessor: SyncRequestProcessor exited!
2017-01-18 10:53:18,277 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: LOOKING
2017-01-18 10:53:18,278 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileSnap: Reading snapshot /home/ubuntu/zookeeper/version-2/snapshot.100000050
2017-01-18 10:53:18,280 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: New election. My id =  0, proposed zxid=0x100000050
2017-01-18 10:53:18,282 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x100000050 (n.zxid), 0x5 (n.round), LOOKING (n.state), 2 (n.sid), 0x4 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:18,283 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x100000050 (n.zxid), 0x5 (n.round), LOOKING (n.state), 1 (n.sid), 0x4 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:18,288 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 3 at election address sue-data-2/172.24.43.151:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:18,288 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x100000050 (n.zxid), 0x5 (n.round), LOOKING (n.state), 0 (n.sid), 0x4 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:18,289 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 4 at election address sue-data-3/172.24.43.150:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:18,290 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:18,291 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 3 at election address sue-data-2/172.24.43.151:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:18,292 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x100000050 (n.zxid), 0x5 (n.round), LOOKING (n.state), 0 (n.sid), 0x4 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:18,292 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 4 at election address sue-data-3/172.24.43.150:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:18,292 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:18,492 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: Notification time out: 400
2017-01-18 10:53:18,493 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x100000050 (n.zxid), 0x5 (n.round), LOOKING (n.state), 0 (n.sid), 0x4 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:18,493 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x100000050 (n.zxid), 0x5 (n.round), LOOKING (n.state), 1 (n.sid), 0x4 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:18,493 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x100000050 (n.zxid), 0x5 (n.round), LOOKING (n.state), 2 (n.sid), 0x4 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:18,494 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 3 at election address sue-data-2/172.24.43.151:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:18,497 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 4 at election address sue-data-3/172.24.43.150:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:18,499 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:18,513 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.148:59688
2017-01-18 10:53:18,513 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:53:18,514 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.148:59688 (no session established for client)
2017-01-18 10:53:18,656 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.151:57154
2017-01-18 10:53:18,658 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:53:18,658 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.151:57154 (no session established for client)
2017-01-18 10:53:18,851 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.148:59694
2017-01-18 10:53:18,852 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:53:18,852 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.148:59694 (no session established for client)
2017-01-18 10:53:18,894 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x100000050 (n.zxid), 0x5 (n.round), LOOKING (n.state), 1 (n.sid), 0x4 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:18,994 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:52412
2017-01-18 10:53:18,994 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:53:18,994 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.157:52412 (no session established for client)
2017-01-18 10:53:19,294 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: Notification time out: 800
2017-01-18 10:53:19,294 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x100000050 (n.zxid), 0x5 (n.round), LOOKING (n.state), 0 (n.sid), 0x4 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:19,295 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x100000050 (n.zxid), 0x5 (n.round), LOOKING (n.state), 2 (n.sid), 0x4 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:19,295 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 3 at election address sue-data-2/172.24.43.151:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:19,296 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 4 at election address sue-data-3/172.24.43.150:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:19,297 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:19,612 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.156:53680
2017-01-18 10:53:19,612 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:53:19,612 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.156:53680 (no session established for client)
2017-01-18 10:53:20,095 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: Notification time out: 1600
2017-01-18 10:53:20,095 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x100000050 (n.zxid), 0x5 (n.round), LOOKING (n.state), 0 (n.sid), 0x4 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:20,096 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x100000050 (n.zxid), 0x5 (n.round), LOOKING (n.state), 1 (n.sid), 0x4 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:20,096 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 3 at election address sue-data-2/172.24.43.151:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:20,097 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 4 at election address sue-data-3/172.24.43.150:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:20,097 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:20,877 WARN  [RecvWorker:2] quorum.QuorumCnxManager: Connection broken for id 2, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 10:53:20,878 WARN  [RecvWorker:2] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 10:53:20,878 WARN  [SendWorker:2] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 10:53:20,878 WARN  [SendWorker:2] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 10:53:21,668 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:52438
2017-01-18 10:53:21,668 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:53:21,668 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.157:52438 (no session established for client)
2017-01-18 10:53:21,696 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: Notification time out: 3200
2017-01-18 10:53:21,696 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x100000050 (n.zxid), 0x5 (n.round), LOOKING (n.state), 0 (n.sid), 0x4 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:53:21,701 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 2 at election address sue-data-1/172.24.43.148:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:21,701 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 3 at election address sue-data-2/172.24.43.151:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:21,703 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 4 at election address sue-data-3/172.24.43.150:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:21,704 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:53:21,850 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:52440
2017-01-18 10:53:21,851 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:53:21,851 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.157:52440 (no session established for client)
2017-01-18 10:53:22,402 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:52448
2017-01-18 10:53:22,403 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:53:22,403 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.157:52448 (no session established for client)
2017-01-18 10:53:22,533 WARN  [RecvWorker:1] quorum.QuorumCnxManager: Connection broken for id 1, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 10:53:22,533 WARN  [RecvWorker:1] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 10:53:22,533 WARN  [SendWorker:1] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 10:53:22,533 WARN  [SendWorker:1] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 10:53:23,491 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:52458
2017-01-18 10:53:23,494 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:53:23,494 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.157:52458 (no session established for client)
Wed Jan 18 10:56:19 UTC 2017 Starting zookeeper on sue-master-1
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 514644
max locked memory       (kbytes, -l) 64
max memory size         (kbytes, -m) unlimited
open files                      (-n) 1024
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) unlimited
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited
2017-01-18 10:56:20,463 WARN  [main] quorum.QuorumPeerConfig: Non-optimial configuration, consider an odd number of servers.
2017-01-18 10:56:20,463 INFO  [main] quorum.QuorumPeerConfig: Defaulting to majority quorums
2017-01-18 10:56:20,554 DEBUG [main] util.Bytes: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.util.Bytes
2017-01-18 10:56:20,557 DEBUG [main] util.VersionInfo: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.util.VersionInfo
2017-01-18 10:56:20,557 DEBUG [main] zookeeper.ZKConfig: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.zookeeper.ZKConfig
2017-01-18 10:56:20,557 DEBUG [main] hbase.HBaseConfiguration: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.HBaseConfiguration
2017-01-18 10:56:20,557 DEBUG [main] hadoop.hbase: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase
2017-01-18 10:56:20,557 INFO  [main] quorum.QuorumPeerMain: Starting quorum peer
2017-01-18 10:56:20,565 INFO  [main] server.NIOServerCnxnFactory: binding to port 0.0.0.0/0.0.0.0:2181
2017-01-18 10:56:20,579 INFO  [main] quorum.QuorumPeer: tickTime set to 3000
2017-01-18 10:56:20,579 INFO  [main] quorum.QuorumPeer: minSessionTimeout set to -1
2017-01-18 10:56:20,579 INFO  [main] quorum.QuorumPeer: maxSessionTimeout set to 90000
2017-01-18 10:56:20,579 INFO  [main] quorum.QuorumPeer: initLimit set to 10
2017-01-18 10:56:20,587 INFO  [main] persistence.FileSnap: Reading snapshot /home/ubuntu/zookeeper/version-2/snapshot.100000050
2017-01-18 10:56:20,603 INFO  [Thread-1] quorum.QuorumCnxManager: My election bind port: 0.0.0.0/0.0.0.0:3888
2017-01-18 10:56:20,608 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: LOOKING
2017-01-18 10:56:20,610 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: New election. My id =  0, proposed zxid=0x100000050
2017-01-18 10:56:20,612 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x100000050 (n.zxid), 0x1 (n.round), LOOKING (n.state), 0 (n.sid), 0x4 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:56:20,613 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (1, 0)
2017-01-18 10:56:20,614 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (2, 0)
2017-01-18 10:56:20,614 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.157:35084
2017-01-18 10:56:20,614 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (3, 0)
2017-01-18 10:56:20,614 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (4, 0)
2017-01-18 10:56:20,616 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (5, 0)
2017-01-18 10:56:20,616 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.148:37392
2017-01-18 10:56:20,616 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.151:47554
2017-01-18 10:56:20,618 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x1 (n.round), LOOKING (n.state), 1 (n.sid), 0x4 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:56:20,618 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x1 (n.round), LOOKING (n.state), 0 (n.sid), 0x4 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:56:20,618 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x1 (n.round), LOOKING (n.state), 2 (n.sid), 0x4 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:56:20,619 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.150:54866
2017-01-18 10:56:20,619 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x1 (n.round), LOOKING (n.state), 3 (n.sid), 0x4 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:56:20,620 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.149:56210
2017-01-18 10:56:20,620 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (5, 0)
2017-01-18 10:56:20,621 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x1 (n.round), LOOKING (n.state), 4 (n.sid), 0x4 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:56:20,621 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.149:56212
2017-01-18 10:56:20,622 WARN  [SendWorker:5] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 10:56:20,624 WARN  [RecvWorker:5] quorum.QuorumCnxManager: Connection broken for id 5, my id = 0, error = 
java.net.SocketException: Socket closed
	at java.net.SocketInputStream.socketRead0(Native Method)
	at java.net.SocketInputStream.socketRead(SocketInputStream.java:116)
	at java.net.SocketInputStream.read(SocketInputStream.java:170)
	at java.net.SocketInputStream.read(SocketInputStream.java:141)
	at java.net.SocketInputStream.read(SocketInputStream.java:223)
	at java.io.DataInputStream.readInt(DataInputStream.java:387)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 10:56:20,626 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x1 (n.round), LOOKING (n.state), 5 (n.sid), 0x4 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:56:20,626 WARN  [RecvWorker:5] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 10:56:20,827 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: FOLLOWING
2017-01-18 10:56:20,833 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: TCP NoDelay set to: true
2017-01-18 10:56:20,853 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:zookeeper.version=3.4.5--1, built on 10/05/2013 16:05 GMT
2017-01-18 10:56:20,853 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:host.name=sue-master-1
2017-01-18 10:56:20,853 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.version=1.8.0_111
2017-01-18 10:56:20,853 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.vendor=Oracle Corporation
2017-01-18 10:56:20,853 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.home=/usr/lib/jvm/java-8-openjdk-amd64/jre
2017-01-18 10:56:20,853 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.class.path=/usr/local/hbase/bin/../conf:/usr/lib/jvm/java-8-openjdk-amd64/jre//lib/tools.jar:/usr/local/hbase/bin/..:/usr/local/hbase/bin/../lib/activation-1.1.jar:/usr/local/hbase/bin/../lib/asm-3.1.jar:/usr/local/hbase/bin/../lib/commons-beanutils-1.7.0.jar:/usr/local/hbase/bin/../lib/commons-beanutils-core-1.8.0.jar:/usr/local/hbase/bin/../lib/commons-cli-1.2.jar:/usr/local/hbase/bin/../lib/commons-codec-1.7.jar:/usr/local/hbase/bin/../lib/commons-collections-3.2.1.jar:/usr/local/hbase/bin/../lib/commons-configuration-1.6.jar:/usr/local/hbase/bin/../lib/commons-digester-1.8.jar:/usr/local/hbase/bin/../lib/commons-el-1.0.jar:/usr/local/hbase/bin/../lib/commons-httpclient-3.1.jar:/usr/local/hbase/bin/../lib/commons-io-2.4.jar:/usr/local/hbase/bin/../lib/commons-lang-2.6.jar:/usr/local/hbase/bin/../lib/commons-logging-1.1.1.jar:/usr/local/hbase/bin/../lib/commons-math-2.2.jar:/usr/local/hbase/bin/../lib/commons-net-1.4.1.jar:/usr/local/hbase/bin/../lib/core-3.1.1.jar:/usr/local/hbase/bin/../lib/findbugs-annotations-1.3.9-1.jar:/usr/local/hbase/bin/../lib/guava-12.0.1.jar:/usr/local/hbase/bin/../lib/hadoop-core-1.2.1.jar:/usr/local/hbase/bin/../lib/hamcrest-core-1.3.jar:/usr/local/hbase/bin/../lib/hbase-client-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-common-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-common-0.98.0-hadoop1-tests.jar:/usr/local/hbase/bin/../lib/hbase-examples-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-hadoop1-compat-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-hadoop-compat-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-it-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-it-0.98.0-hadoop1-tests.jar:/usr/local/hbase/bin/../lib/hbase-prefix-tree-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-protocol-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-server-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-server-0.98.0-hadoop1-tests.jar:/usr/local/hbase/bin/../lib/hbase-shell-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-testing-util-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-thrift-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/high-scale-lib-1.1.1.jar:/usr/local/hbase/bin/../lib/htrace-core-2.04.jar:/usr/local/hbase/bin/../lib/httpclient-4.1.3.jar:/usr/local/hbase/bin/../lib/httpcore-4.1.3.jar:/usr/local/hbase/bin/../lib/jackson-core-asl-1.8.8.jar:/usr/local/hbase/bin/../lib/jackson-jaxrs-1.8.8.jar:/usr/local/hbase/bin/../lib/jackson-mapper-asl-1.8.8.jar:/usr/local/hbase/bin/../lib/jackson-xc-1.8.8.jar:/usr/local/hbase/bin/../lib/jamon-runtime-2.3.1.jar:/usr/local/hbase/bin/../lib/jasper-compiler-5.5.23.jar:/usr/local/hbase/bin/../lib/jasper-runtime-5.5.23.jar:/usr/local/hbase/bin/../lib/jaxb-api-2.2.2.jar:/usr/local/hbase/bin/../lib/jaxb-impl-2.2.3-1.jar:/usr/local/hbase/bin/../lib/jersey-core-1.8.jar:/usr/local/hbase/bin/../lib/jersey-json-1.8.jar:/usr/local/hbase/bin/../lib/jersey-server-1.8.jar:/usr/local/hbase/bin/../lib/jettison-1.3.1.jar:/usr/local/hbase/bin/../lib/jetty-6.1.26.jar:/usr/local/hbase/bin/../lib/jetty-sslengine-6.1.26.jar:/usr/local/hbase/bin/../lib/jetty-util-6.1.26.jar:/usr/local/hbase/bin/../lib/jruby-complete-1.6.8.jar:/usr/local/hbase/bin/../lib/jsp-2.1-6.1.14.jar:/usr/local/hbase/bin/../lib/jsp-api-2.1-6.1.14.jar:/usr/local/hbase/bin/../lib/jsr305-1.3.9.jar:/usr/local/hbase/bin/../lib/junit-4.11.jar:/usr/local/hbase/bin/../lib/libthrift-0.9.0.jar:/usr/local/hbase/bin/../lib/log4j-1.2.17.jar:/usr/local/hbase/bin/../lib/metrics-core-2.1.2.jar:/usr/local/hbase/bin/../lib/netty-3.6.6.Final.jar:/usr/local/hbase/bin/../lib/protobuf-java-2.5.0.jar:/usr/local/hbase/bin/../lib/servlet-api-2.5-6.1.14.jar:/usr/local/hbase/bin/../lib/slf4j-api-1.6.4.jar:/usr/local/hbase/bin/../lib/slf4j-log4j12-1.6.4.jar:/usr/local/hbase/bin/../lib/stax-api-1.0.1.jar:/usr/local/hbase/bin/../lib/xmlenc-0.52.jar:/usr/local/hbase/bin/../lib/zookeeper-3.4.5.jar:
2017-01-18 10:56:20,853 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.library.path=/usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2017-01-18 10:56:20,853 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.io.tmpdir=/tmp
2017-01-18 10:56:20,853 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.compiler=<NA>
2017-01-18 10:56:20,853 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:os.name=Linux
2017-01-18 10:56:20,854 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:os.arch=amd64
2017-01-18 10:56:20,855 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:os.version=4.4.0-53-generic
2017-01-18 10:56:20,856 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:user.name=ubuntu
2017-01-18 10:56:20,856 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:user.home=/home/ubuntu
2017-01-18 10:56:20,856 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:user.dir=/usr/local/hbase
2017-01-18 10:56:20,857 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 90000 datadir /home/ubuntu/zookeeper/version-2 snapdir /home/ubuntu/zookeeper/version-2
2017-01-18 10:56:20,858 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: FOLLOWING - LEADER ELECTION TOOK - 248
2017-01-18 10:56:21,851 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Getting a diff from the leader 0x100000050
2017-01-18 10:56:21,857 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileTxnSnapLog: Snapshotting: 0x100000050 to /home/ubuntu/zookeeper/version-2/snapshot.100000050
2017-01-18 10:56:21,864 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileTxnSnapLog: Snapshotting: 0x100000050 to /home/ubuntu/zookeeper/version-2/snapshot.100000050
2017-01-18 10:56:22,179 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Got zxid 0x500000001 expected 0x1
2017-01-18 10:56:22,179 INFO  [SyncThread:0] persistence.FileTxnLog: Creating new log file: log.500000001
2017-01-18 10:56:23,874 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.148:59762
2017-01-18 10:56:24,031 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to establish new session at /172.24.43.148:59762
2017-01-18 10:56:24,037 INFO  [CommitProcessor:0] server.ZooKeeperServer: Established session 0x59b1386b5f0000 with negotiated timeout 90000 for client /172.24.43.148:59762
2017-01-18 10:56:30,041 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.156:53794
2017-01-18 10:56:30,041 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to establish new session at /172.24.43.156:53794
2017-01-18 10:56:30,044 INFO  [CommitProcessor:0] server.ZooKeeperServer: Established session 0x59b1386b5f0001 with negotiated timeout 90000 for client /172.24.43.156:53794
2017-01-18 10:56:35,056 WARN  [RecvWorker:5] quorum.QuorumCnxManager: Connection broken for id 5, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 10:56:35,056 WARN  [RecvWorker:5] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 10:56:35,057 WARN  [SendWorker:5] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 10:56:35,057 WARN  [SendWorker:5] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 10:56:35,644 WARN  [RecvWorker:4] quorum.QuorumCnxManager: Connection broken for id 4, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 10:56:35,645 WARN  [RecvWorker:4] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 10:56:35,645 WARN  [SendWorker:4] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 10:56:35,645 WARN  [SendWorker:4] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 10:56:36,023 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.150:40084
2017-01-18 10:56:36,031 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to establish new session at /172.24.43.150:40084
2017-01-18 10:56:36,034 INFO  [CommitProcessor:0] server.ZooKeeperServer: Established session 0x59b1386b5f0002 with negotiated timeout 30000 for client /172.24.43.150:40084
2017-01-18 10:56:36,298 WARN  [RecvWorker:3] quorum.QuorumCnxManager: Connection broken for id 3, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 10:56:36,299 WARN  [RecvWorker:3] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 10:56:36,299 WARN  [SendWorker:3] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 10:56:36,299 WARN  [SendWorker:3] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 10:56:36,299 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Exception when following the leader
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)
	at org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:83)
	at org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:108)
	at org.apache.zookeeper.server.quorum.Learner.readPacket(Learner.java:152)
	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:85)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:740)
2017-01-18 10:56:36,300 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: shutdown called
java.lang.Exception: shutdown Follower
	at org.apache.zookeeper.server.quorum.Follower.shutdown(Follower.java:166)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:744)
2017-01-18 10:56:36,301 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.148:59762 which had sessionid 0x59b1386b5f0000
2017-01-18 10:56:36,310 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.156:53794 which had sessionid 0x59b1386b5f0001
2017-01-18 10:56:36,310 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.150:40084 which had sessionid 0x59b1386b5f0002
2017-01-18 10:56:36,311 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FollowerZooKeeperServer: Shutting down
2017-01-18 10:56:36,311 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: shutting down
2017-01-18 10:56:36,311 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FollowerRequestProcessor: Shutting down
2017-01-18 10:56:36,311 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.CommitProcessor: Shutting down
2017-01-18 10:56:36,311 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.FinalRequestProcessor: shutdown of request processor complete
2017-01-18 10:56:36,311 INFO  [FollowerRequestProcessor:0] quorum.FollowerRequestProcessor: FollowerRequestProcessor exited loop!
2017-01-18 10:56:36,311 INFO  [CommitProcessor:0] quorum.CommitProcessor: CommitProcessor exited loop!
2017-01-18 10:56:36,312 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 1 (n.leader), 0x500000042 (n.zxid), 0x2 (n.round), LOOKING (n.state), 1 (n.sid), 0x5 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 10:56:36,312 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.SyncRequestProcessor: Shutting down
2017-01-18 10:56:36,312 INFO  [SyncThread:0] server.SyncRequestProcessor: SyncRequestProcessor exited!
2017-01-18 10:56:36,312 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: LOOKING
2017-01-18 10:56:36,313 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileSnap: Reading snapshot /home/ubuntu/zookeeper/version-2/snapshot.100000050
2017-01-18 10:56:36,316 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x500000042 (n.zxid), 0x2 (n.round), LOOKING (n.state), 2 (n.sid), 0x5 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:56:36,319 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x500000042 (n.zxid), 0x2 (n.round), LOOKING (n.state), 1 (n.sid), 0x5 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:56:36,331 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: New election. My id =  0, proposed zxid=0x500000042
2017-01-18 10:56:36,331 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x500000042 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x5 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:56:36,332 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 3 at election address sue-data-2/172.24.43.151:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:56:36,333 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 4 at election address sue-data-3/172.24.43.150:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:56:36,334 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:56:36,335 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 3 at election address sue-data-2/172.24.43.151:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:56:36,336 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x500000042 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x5 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:56:36,336 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 4 at election address sue-data-3/172.24.43.150:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:56:36,337 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:56:36,537 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x500000042 (n.zxid), 0x2 (n.round), LOOKING (n.state), 1 (n.sid), 0x5 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:56:36,537 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x500000042 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x5 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:56:36,538 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 3 at election address sue-data-2/172.24.43.151:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:56:36,544 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: Notification time out: 400
2017-01-18 10:56:36,545 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 4 at election address sue-data-3/172.24.43.150:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:56:36,546 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:56:36,738 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.148:59784
2017-01-18 10:56:36,739 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:56:36,739 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.148:59784 (no session established for client)
2017-01-18 10:56:36,741 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x500000042 (n.zxid), 0x2 (n.round), LOOKING (n.state), 2 (n.sid), 0x5 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:56:36,844 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.148:59792
2017-01-18 10:56:36,845 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:56:36,845 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.148:59792 (no session established for client)
2017-01-18 10:56:36,997 WARN  [RecvWorker:2] quorum.QuorumCnxManager: Connection broken for id 2, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 10:56:36,998 WARN  [RecvWorker:2] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 10:56:36,998 WARN  [SendWorker:2] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 10:56:36,998 WARN  [SendWorker:2] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 10:56:37,141 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x500000042 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x5 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:56:37,142 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x500000042 (n.zxid), 0x2 (n.round), LOOKING (n.state), 1 (n.sid), 0x5 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:56:37,143 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: Notification time out: 800
2017-01-18 10:56:37,143 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 2 at election address sue-data-1/172.24.43.148:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:56:37,144 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 3 at election address sue-data-2/172.24.43.151:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:56:37,146 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 4 at election address sue-data-3/172.24.43.150:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:56:37,147 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:56:37,589 WARN  [RecvWorker:1] quorum.QuorumCnxManager: Connection broken for id 1, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 10:56:37,589 WARN  [RecvWorker:1] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 10:56:37,590 WARN  [SendWorker:1] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 10:56:37,590 WARN  [SendWorker:1] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 10:56:37,947 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: Notification time out: 1600
2017-01-18 10:56:37,947 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x500000042 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x5 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:56:37,948 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 1 at election address sue-master-2/172.24.43.157:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:56:37,949 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 2 at election address sue-data-1/172.24.43.148:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:56:37,949 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 3 at election address sue-data-2/172.24.43.151:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:56:37,953 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 4 at election address sue-data-3/172.24.43.150:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:56:37,954 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
Wed Jan 18 10:57:05 UTC 2017 Starting zookeeper on sue-master-1
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 514644
max locked memory       (kbytes, -l) 64
max memory size         (kbytes, -m) unlimited
open files                      (-n) 1024
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) unlimited
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited
2017-01-18 10:57:05,576 WARN  [main] quorum.QuorumPeerConfig: Non-optimial configuration, consider an odd number of servers.
2017-01-18 10:57:05,577 INFO  [main] quorum.QuorumPeerConfig: Defaulting to majority quorums
2017-01-18 10:57:05,655 DEBUG [main] util.Bytes: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.util.Bytes
2017-01-18 10:57:05,656 DEBUG [main] util.VersionInfo: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.util.VersionInfo
2017-01-18 10:57:05,656 DEBUG [main] zookeeper.ZKConfig: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.zookeeper.ZKConfig
2017-01-18 10:57:05,656 DEBUG [main] hbase.HBaseConfiguration: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.HBaseConfiguration
2017-01-18 10:57:05,657 DEBUG [main] hadoop.hbase: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase
2017-01-18 10:57:05,657 INFO  [main] quorum.QuorumPeerMain: Starting quorum peer
2017-01-18 10:57:05,667 INFO  [main] server.NIOServerCnxnFactory: binding to port 0.0.0.0/0.0.0.0:2181
2017-01-18 10:57:05,679 INFO  [main] quorum.QuorumPeer: tickTime set to 3000
2017-01-18 10:57:05,679 INFO  [main] quorum.QuorumPeer: minSessionTimeout set to -1
2017-01-18 10:57:05,680 INFO  [main] quorum.QuorumPeer: maxSessionTimeout set to 90000
2017-01-18 10:57:05,680 INFO  [main] quorum.QuorumPeer: initLimit set to 10
2017-01-18 10:57:05,689 INFO  [main] quorum.QuorumPeer: currentEpoch not found! Creating with a reasonable default of 0. This should only happen when you are upgrading your installation
2017-01-18 10:57:05,690 INFO  [main] quorum.QuorumPeer: acceptedEpoch not found! Creating with a reasonable default of 0. This should only happen when you are upgrading your installation
2017-01-18 10:57:05,697 INFO  [Thread-1] quorum.QuorumCnxManager: My election bind port: 0.0.0.0/0.0.0.0:3888
2017-01-18 10:57:05,705 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: LOOKING
2017-01-18 10:57:05,707 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: New election. My id =  0, proposed zxid=0x0
2017-01-18 10:57:05,710 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 0 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:05,710 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.157:35188
2017-01-18 10:57:05,711 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (1, 0)
2017-01-18 10:57:05,712 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 2 at election address sue-data-1/172.24.43.148:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:57:05,714 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (3, 0)
2017-01-18 10:57:05,714 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 4 at election address sue-data-3/172.24.43.150:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:57:05,715 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:57:05,727 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.157:35192
2017-01-18 10:57:05,728 WARN  [SendWorker:1] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 10:57:05,730 WARN  [SendWorker:1] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 10:57:05,730 WARN  [RecvWorker:1] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 10:57:05,730 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 1 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 1 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:05,730 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 1 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:05,729 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.151:47694
2017-01-18 10:57:05,732 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 1 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 0 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:05,732 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 3 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:05,733 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 2 at election address sue-data-1/172.24.43.148:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:57:05,734 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 4 at election address sue-data-3/172.24.43.150:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:57:05,734 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:57:05,734 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 0 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:05,735 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 2 at election address sue-data-1/172.24.43.148:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:57:05,736 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (4, 0)
2017-01-18 10:57:05,737 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:57:05,740 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.150:54902
2017-01-18 10:57:05,746 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 4 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:05,747 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 0 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:05,747 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 2 at election address sue-data-1/172.24.43.148:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:57:05,748 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (5, 0)
2017-01-18 10:57:05,750 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 1 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:05,751 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.149:56246
2017-01-18 10:57:05,751 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 3 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:05,753 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 5 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:05,753 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 0 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:05,754 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 2 at election address sue-data-1/172.24.43.148:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:57:05,755 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 1 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:05,755 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 3 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:05,756 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 4 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:05,830 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.148:37444
2017-01-18 10:57:05,832 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 2 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:05,840 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 2 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:06,041 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: FOLLOWING
2017-01-18 10:57:06,048 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: TCP NoDelay set to: true
2017-01-18 10:57:06,062 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:zookeeper.version=3.4.5--1, built on 10/05/2013 16:05 GMT
2017-01-18 10:57:06,063 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:host.name=sue-master-1
2017-01-18 10:57:06,063 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.version=1.8.0_111
2017-01-18 10:57:06,063 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.vendor=Oracle Corporation
2017-01-18 10:57:06,063 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.home=/usr/lib/jvm/java-8-openjdk-amd64/jre
2017-01-18 10:57:06,063 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.class.path=/usr/local/hbase/bin/../conf:/usr/lib/jvm/java-8-openjdk-amd64/jre//lib/tools.jar:/usr/local/hbase/bin/..:/usr/local/hbase/bin/../lib/activation-1.1.jar:/usr/local/hbase/bin/../lib/asm-3.1.jar:/usr/local/hbase/bin/../lib/commons-beanutils-1.7.0.jar:/usr/local/hbase/bin/../lib/commons-beanutils-core-1.8.0.jar:/usr/local/hbase/bin/../lib/commons-cli-1.2.jar:/usr/local/hbase/bin/../lib/commons-codec-1.7.jar:/usr/local/hbase/bin/../lib/commons-collections-3.2.1.jar:/usr/local/hbase/bin/../lib/commons-configuration-1.6.jar:/usr/local/hbase/bin/../lib/commons-digester-1.8.jar:/usr/local/hbase/bin/../lib/commons-el-1.0.jar:/usr/local/hbase/bin/../lib/commons-httpclient-3.1.jar:/usr/local/hbase/bin/../lib/commons-io-2.4.jar:/usr/local/hbase/bin/../lib/commons-lang-2.6.jar:/usr/local/hbase/bin/../lib/commons-logging-1.1.1.jar:/usr/local/hbase/bin/../lib/commons-math-2.2.jar:/usr/local/hbase/bin/../lib/commons-net-1.4.1.jar:/usr/local/hbase/bin/../lib/core-3.1.1.jar:/usr/local/hbase/bin/../lib/findbugs-annotations-1.3.9-1.jar:/usr/local/hbase/bin/../lib/guava-12.0.1.jar:/usr/local/hbase/bin/../lib/hadoop-core-1.2.1.jar:/usr/local/hbase/bin/../lib/hamcrest-core-1.3.jar:/usr/local/hbase/bin/../lib/hbase-client-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-common-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-common-0.98.0-hadoop1-tests.jar:/usr/local/hbase/bin/../lib/hbase-examples-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-hadoop1-compat-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-hadoop-compat-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-it-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-it-0.98.0-hadoop1-tests.jar:/usr/local/hbase/bin/../lib/hbase-prefix-tree-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-protocol-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-server-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-server-0.98.0-hadoop1-tests.jar:/usr/local/hbase/bin/../lib/hbase-shell-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-testing-util-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-thrift-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/high-scale-lib-1.1.1.jar:/usr/local/hbase/bin/../lib/htrace-core-2.04.jar:/usr/local/hbase/bin/../lib/httpclient-4.1.3.jar:/usr/local/hbase/bin/../lib/httpcore-4.1.3.jar:/usr/local/hbase/bin/../lib/jackson-core-asl-1.8.8.jar:/usr/local/hbase/bin/../lib/jackson-jaxrs-1.8.8.jar:/usr/local/hbase/bin/../lib/jackson-mapper-asl-1.8.8.jar:/usr/local/hbase/bin/../lib/jackson-xc-1.8.8.jar:/usr/local/hbase/bin/../lib/jamon-runtime-2.3.1.jar:/usr/local/hbase/bin/../lib/jasper-compiler-5.5.23.jar:/usr/local/hbase/bin/../lib/jasper-runtime-5.5.23.jar:/usr/local/hbase/bin/../lib/jaxb-api-2.2.2.jar:/usr/local/hbase/bin/../lib/jaxb-impl-2.2.3-1.jar:/usr/local/hbase/bin/../lib/jersey-core-1.8.jar:/usr/local/hbase/bin/../lib/jersey-json-1.8.jar:/usr/local/hbase/bin/../lib/jersey-server-1.8.jar:/usr/local/hbase/bin/../lib/jettison-1.3.1.jar:/usr/local/hbase/bin/../lib/jetty-6.1.26.jar:/usr/local/hbase/bin/../lib/jetty-sslengine-6.1.26.jar:/usr/local/hbase/bin/../lib/jetty-util-6.1.26.jar:/usr/local/hbase/bin/../lib/jruby-complete-1.6.8.jar:/usr/local/hbase/bin/../lib/jsp-2.1-6.1.14.jar:/usr/local/hbase/bin/../lib/jsp-api-2.1-6.1.14.jar:/usr/local/hbase/bin/../lib/jsr305-1.3.9.jar:/usr/local/hbase/bin/../lib/junit-4.11.jar:/usr/local/hbase/bin/../lib/libthrift-0.9.0.jar:/usr/local/hbase/bin/../lib/log4j-1.2.17.jar:/usr/local/hbase/bin/../lib/metrics-core-2.1.2.jar:/usr/local/hbase/bin/../lib/netty-3.6.6.Final.jar:/usr/local/hbase/bin/../lib/protobuf-java-2.5.0.jar:/usr/local/hbase/bin/../lib/servlet-api-2.5-6.1.14.jar:/usr/local/hbase/bin/../lib/slf4j-api-1.6.4.jar:/usr/local/hbase/bin/../lib/slf4j-log4j12-1.6.4.jar:/usr/local/hbase/bin/../lib/stax-api-1.0.1.jar:/usr/local/hbase/bin/../lib/xmlenc-0.52.jar:/usr/local/hbase/bin/../lib/zookeeper-3.4.5.jar:
2017-01-18 10:57:06,063 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.library.path=/usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2017-01-18 10:57:06,063 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.io.tmpdir=/tmp
2017-01-18 10:57:06,063 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.compiler=<NA>
2017-01-18 10:57:06,063 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:os.name=Linux
2017-01-18 10:57:06,063 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:os.arch=amd64
2017-01-18 10:57:06,063 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:os.version=4.4.0-53-generic
2017-01-18 10:57:06,063 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:user.name=ubuntu
2017-01-18 10:57:06,063 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:user.home=/home/ubuntu
2017-01-18 10:57:06,063 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:user.dir=/usr/local/hbase
2017-01-18 10:57:06,065 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 90000 datadir /home/ubuntu/zookeeper/version-2 snapdir /home/ubuntu/zookeeper/version-2
2017-01-18 10:57:06,066 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: FOLLOWING - LEADER ELECTION TOOK - 359
2017-01-18 10:57:06,089 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Getting a diff from the leader 0x0
2017-01-18 10:57:06,093 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileTxnSnapLog: Snapshotting: 0x0 to /home/ubuntu/zookeeper/version-2/snapshot.0
2017-01-18 10:57:06,099 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileTxnSnapLog: Snapshotting: 0x0 to /home/ubuntu/zookeeper/version-2/snapshot.0
2017-01-18 10:57:07,443 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Got zxid 0x100000001 expected 0x1
2017-01-18 10:57:07,443 INFO  [SyncThread:0] persistence.FileTxnLog: Creating new log file: log.100000001
2017-01-18 10:57:09,189 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.148:59820
2017-01-18 10:57:09,303 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to establish new session at /172.24.43.148:59820
2017-01-18 10:57:09,307 INFO  [CommitProcessor:0] server.ZooKeeperServer: Established session 0x59b139182d0000 with negotiated timeout 90000 for client /172.24.43.148:59820
2017-01-18 10:57:10,273 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.149:37666
2017-01-18 10:57:10,274 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to establish new session at /172.24.43.149:37666
2017-01-18 10:57:10,282 INFO  [CommitProcessor:0] server.ZooKeeperServer: Established session 0x59b139182d0001 with negotiated timeout 90000 for client /172.24.43.149:37666
2017-01-18 10:57:16,819 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Exception when following the leader
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)
	at org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:83)
	at org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:108)
	at org.apache.zookeeper.server.quorum.Learner.readPacket(Learner.java:152)
	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:85)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:740)
2017-01-18 10:57:16,823 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: caught end of stream exception
EndOfStreamException: Unable to read additional data from client sessionid 0x59b139182d0001, likely client has closed socket
	at org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:220)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:208)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:57:16,819 WARN  [RecvWorker:5] quorum.QuorumCnxManager: Connection broken for id 5, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 10:57:16,825 WARN  [RecvWorker:5] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 10:57:16,826 WARN  [SendWorker:5] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 10:57:16,826 WARN  [SendWorker:5] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 10:57:16,826 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.149:37666 which had sessionid 0x59b139182d0001
2017-01-18 10:57:16,828 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: shutdown called
java.lang.Exception: shutdown Follower
	at org.apache.zookeeper.server.quorum.Follower.shutdown(Follower.java:166)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:744)
2017-01-18 10:57:16,829 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.148:59820 which had sessionid 0x59b139182d0000
2017-01-18 10:57:16,830 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FollowerZooKeeperServer: Shutting down
2017-01-18 10:57:16,830 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: shutting down
2017-01-18 10:57:16,830 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FollowerRequestProcessor: Shutting down
2017-01-18 10:57:16,830 INFO  [FollowerRequestProcessor:0] quorum.FollowerRequestProcessor: FollowerRequestProcessor exited loop!
2017-01-18 10:57:16,830 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.CommitProcessor: Shutting down
2017-01-18 10:57:16,830 INFO  [CommitProcessor:0] quorum.CommitProcessor: CommitProcessor exited loop!
2017-01-18 10:57:16,830 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.FinalRequestProcessor: shutdown of request processor complete
2017-01-18 10:57:16,831 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.SyncRequestProcessor: Shutting down
2017-01-18 10:57:16,831 INFO  [SyncThread:0] server.SyncRequestProcessor: SyncRequestProcessor exited!
2017-01-18 10:57:16,831 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: LOOKING
2017-01-18 10:57:16,833 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileSnap: Reading snapshot /home/ubuntu/zookeeper/version-2/snapshot.0
2017-01-18 10:57:16,837 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000047 (n.zxid), 0x2 (n.round), LOOKING (n.state), 4 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:16,839 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000047 (n.zxid), 0x2 (n.round), LOOKING (n.state), 3 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:16,842 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: New election. My id =  0, proposed zxid=0x100000047
2017-01-18 10:57:16,842 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x100000047 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:16,843 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 1 (n.leader), 0x100000047 (n.zxid), 0x2 (n.round), LOOKING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:16,844 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:57:16,844 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000047 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:16,845 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000047 (n.zxid), 0x2 (n.round), LOOKING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:16,845 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 10:57:16,846 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000047 (n.zxid), 0x2 (n.round), LOOKING (n.state), 3 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:16,846 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000047 (n.zxid), 0x2 (n.round), LOOKING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:16,864 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x100000047 (n.zxid), 0x2 (n.round), LOOKING (n.state), 2 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:16,867 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000047 (n.zxid), 0x2 (n.round), LOOKING (n.state), 2 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:17,067 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: FOLLOWING
2017-01-18 10:57:17,067 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 90000 datadir /home/ubuntu/zookeeper/version-2 snapdir /home/ubuntu/zookeeper/version-2
2017-01-18 10:57:17,067 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: FOLLOWING - LEADER ELECTION TOOK - 236
2017-01-18 10:57:17,068 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Unexpected exception, tries=0, connecting to sue-data-3/172.24.43.150:2888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.Learner.connectToLeader(Learner.java:224)
	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:71)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:740)
2017-01-18 10:57:17,193 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.149:37678
2017-01-18 10:57:17,195 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:57:17,195 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.149:37678 (no session established for client)
2017-01-18 10:57:17,274 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.150:40138
2017-01-18 10:57:17,274 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:57:17,274 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.150:40138 (no session established for client)
2017-01-18 10:57:17,395 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.150:40142
2017-01-18 10:57:17,395 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:57:17,396 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.150:40142 (no session established for client)
2017-01-18 10:57:17,838 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:52706
2017-01-18 10:57:17,838 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:57:17,839 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.157:52706 (no session established for client)
2017-01-18 10:57:17,858 WARN  [RecvWorker:4] quorum.QuorumCnxManager: Connection broken for id 4, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 10:57:17,859 WARN  [RecvWorker:4] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 10:57:17,859 WARN  [SendWorker:4] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 10:57:17,859 WARN  [SendWorker:4] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 10:57:18,036 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.148:59854
2017-01-18 10:57:18,037 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:57:18,037 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.148:59854 (no session established for client)
2017-01-18 10:57:18,069 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Unexpected exception, tries=1, connecting to sue-data-3/172.24.43.150:2888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.Learner.connectToLeader(Learner.java:224)
	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:71)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:740)
2017-01-18 10:57:18,368 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.151:57486
2017-01-18 10:57:18,369 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:57:18,369 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.151:57486 (no session established for client)
2017-01-18 10:57:18,585 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.151:57490
2017-01-18 10:57:18,586 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:57:18,586 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.151:57490 (no session established for client)
2017-01-18 10:57:18,687 WARN  [RecvWorker:3] quorum.QuorumCnxManager: Connection broken for id 3, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 10:57:18,687 WARN  [RecvWorker:3] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 10:57:18,688 WARN  [SendWorker:3] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 10:57:18,688 WARN  [SendWorker:3] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 10:57:18,763 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.148:59864
2017-01-18 10:57:18,764 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:57:18,764 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.148:59864 (no session established for client)
2017-01-18 10:57:19,071 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Unexpected exception, tries=2, connecting to sue-data-3/172.24.43.150:2888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.Learner.connectToLeader(Learner.java:224)
	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:71)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:740)
2017-01-18 10:57:19,112 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.151:57496
2017-01-18 10:57:19,114 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:57:19,114 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.151:57496 (no session established for client)
2017-01-18 10:57:19,175 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:52726
2017-01-18 10:57:19,175 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:57:19,175 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.157:52726 (no session established for client)
2017-01-18 10:57:19,419 WARN  [RecvWorker:2] quorum.QuorumCnxManager: Connection broken for id 2, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 10:57:19,419 WARN  [RecvWorker:2] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 10:57:19,419 WARN  [SendWorker:2] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 10:57:19,420 WARN  [SendWorker:2] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 10:57:19,911 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:52732
2017-01-18 10:57:19,914 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:57:19,914 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.157:52732 (no session established for client)
2017-01-18 10:57:20,007 WARN  [RecvWorker:1] quorum.QuorumCnxManager: Connection broken for id 1, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 10:57:20,008 WARN  [RecvWorker:1] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 10:57:20,008 WARN  [SendWorker:1] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 10:57:20,008 WARN  [SendWorker:1] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 10:57:20,072 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Unexpected exception, tries=3, connecting to sue-data-3/172.24.43.150:2888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.Learner.connectToLeader(Learner.java:224)
	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:71)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:740)
2017-01-18 10:57:20,407 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.156:54018
2017-01-18 10:57:20,408 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:57:20,408 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.156:54018 (no session established for client)
2017-01-18 10:57:20,492 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:52734
2017-01-18 10:57:20,493 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 10:57:20,493 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.157:52734 (no session established for client)
Wed Jan 18 10:57:48 UTC 2017 Starting zookeeper on sue-master-1
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 514644
max locked memory       (kbytes, -l) 64
max memory size         (kbytes, -m) unlimited
open files                      (-n) 1024
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) unlimited
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited
2017-01-18 10:57:49,340 WARN  [main] quorum.QuorumPeerConfig: Non-optimial configuration, consider an odd number of servers.
2017-01-18 10:57:49,340 INFO  [main] quorum.QuorumPeerConfig: Defaulting to majority quorums
2017-01-18 10:57:49,420 DEBUG [main] util.Bytes: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.util.Bytes
2017-01-18 10:57:49,421 DEBUG [main] util.VersionInfo: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.util.VersionInfo
2017-01-18 10:57:49,421 DEBUG [main] zookeeper.ZKConfig: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.zookeeper.ZKConfig
2017-01-18 10:57:49,421 DEBUG [main] hbase.HBaseConfiguration: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.HBaseConfiguration
2017-01-18 10:57:49,421 DEBUG [main] hadoop.hbase: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase
2017-01-18 10:57:49,421 INFO  [main] quorum.QuorumPeerMain: Starting quorum peer
2017-01-18 10:57:49,429 INFO  [main] server.NIOServerCnxnFactory: binding to port 0.0.0.0/0.0.0.0:2181
2017-01-18 10:57:49,441 INFO  [main] quorum.QuorumPeer: tickTime set to 3000
2017-01-18 10:57:49,441 INFO  [main] quorum.QuorumPeer: minSessionTimeout set to -1
2017-01-18 10:57:49,441 INFO  [main] quorum.QuorumPeer: maxSessionTimeout set to 90000
2017-01-18 10:57:49,441 INFO  [main] quorum.QuorumPeer: initLimit set to 10
2017-01-18 10:57:49,450 INFO  [main] quorum.QuorumPeer: currentEpoch not found! Creating with a reasonable default of 0. This should only happen when you are upgrading your installation
2017-01-18 10:57:49,451 INFO  [main] quorum.QuorumPeer: acceptedEpoch not found! Creating with a reasonable default of 0. This should only happen when you are upgrading your installation
2017-01-18 10:57:49,455 INFO  [Thread-1] quorum.QuorumCnxManager: My election bind port: 0.0.0.0/0.0.0.0:3888
2017-01-18 10:57:49,468 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: LOOKING
2017-01-18 10:57:49,469 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: New election. My id =  0, proposed zxid=0x0
2017-01-18 10:57:49,470 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 0 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:49,471 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (1, 0)
2017-01-18 10:57:49,472 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (2, 0)
2017-01-18 10:57:49,472 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.157:35352
2017-01-18 10:57:49,472 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (3, 0)
2017-01-18 10:57:49,474 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.148:37538
2017-01-18 10:57:49,475 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 1 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:49,476 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.151:47862
2017-01-18 10:57:49,477 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 2 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:49,477 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 3 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:49,478 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (4, 0)
2017-01-18 10:57:49,478 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.150:54996
2017-01-18 10:57:49,479 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (5, 0)
2017-01-18 10:57:49,479 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 0 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:49,480 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.149:56324
2017-01-18 10:57:49,480 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 4 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:49,482 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 5 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 10:57:49,682 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: FOLLOWING
2017-01-18 10:57:49,689 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: TCP NoDelay set to: true
2017-01-18 10:57:49,714 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:zookeeper.version=3.4.5--1, built on 10/05/2013 16:05 GMT
2017-01-18 10:57:49,714 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:host.name=sue-master-1
2017-01-18 10:57:49,714 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.version=1.8.0_111
2017-01-18 10:57:49,714 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.vendor=Oracle Corporation
2017-01-18 10:57:49,714 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.home=/usr/lib/jvm/java-8-openjdk-amd64/jre
2017-01-18 10:57:49,714 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.class.path=/usr/local/hbase/bin/../conf:/usr/lib/jvm/java-8-openjdk-amd64/jre//lib/tools.jar:/usr/local/hbase/bin/..:/usr/local/hbase/bin/../lib/activation-1.1.jar:/usr/local/hbase/bin/../lib/asm-3.1.jar:/usr/local/hbase/bin/../lib/commons-beanutils-1.7.0.jar:/usr/local/hbase/bin/../lib/commons-beanutils-core-1.8.0.jar:/usr/local/hbase/bin/../lib/commons-cli-1.2.jar:/usr/local/hbase/bin/../lib/commons-codec-1.7.jar:/usr/local/hbase/bin/../lib/commons-collections-3.2.1.jar:/usr/local/hbase/bin/../lib/commons-configuration-1.6.jar:/usr/local/hbase/bin/../lib/commons-digester-1.8.jar:/usr/local/hbase/bin/../lib/commons-el-1.0.jar:/usr/local/hbase/bin/../lib/commons-httpclient-3.1.jar:/usr/local/hbase/bin/../lib/commons-io-2.4.jar:/usr/local/hbase/bin/../lib/commons-lang-2.6.jar:/usr/local/hbase/bin/../lib/commons-logging-1.1.1.jar:/usr/local/hbase/bin/../lib/commons-math-2.2.jar:/usr/local/hbase/bin/../lib/commons-net-1.4.1.jar:/usr/local/hbase/bin/../lib/core-3.1.1.jar:/usr/local/hbase/bin/../lib/findbugs-annotations-1.3.9-1.jar:/usr/local/hbase/bin/../lib/guava-12.0.1.jar:/usr/local/hbase/bin/../lib/hadoop-core-1.2.1.jar:/usr/local/hbase/bin/../lib/hamcrest-core-1.3.jar:/usr/local/hbase/bin/../lib/hbase-client-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-common-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-common-0.98.0-hadoop1-tests.jar:/usr/local/hbase/bin/../lib/hbase-examples-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-hadoop1-compat-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-hadoop-compat-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-it-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-it-0.98.0-hadoop1-tests.jar:/usr/local/hbase/bin/../lib/hbase-prefix-tree-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-protocol-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-server-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-server-0.98.0-hadoop1-tests.jar:/usr/local/hbase/bin/../lib/hbase-shell-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-testing-util-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-thrift-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/high-scale-lib-1.1.1.jar:/usr/local/hbase/bin/../lib/htrace-core-2.04.jar:/usr/local/hbase/bin/../lib/httpclient-4.1.3.jar:/usr/local/hbase/bin/../lib/httpcore-4.1.3.jar:/usr/local/hbase/bin/../lib/jackson-core-asl-1.8.8.jar:/usr/local/hbase/bin/../lib/jackson-jaxrs-1.8.8.jar:/usr/local/hbase/bin/../lib/jackson-mapper-asl-1.8.8.jar:/usr/local/hbase/bin/../lib/jackson-xc-1.8.8.jar:/usr/local/hbase/bin/../lib/jamon-runtime-2.3.1.jar:/usr/local/hbase/bin/../lib/jasper-compiler-5.5.23.jar:/usr/local/hbase/bin/../lib/jasper-runtime-5.5.23.jar:/usr/local/hbase/bin/../lib/jaxb-api-2.2.2.jar:/usr/local/hbase/bin/../lib/jaxb-impl-2.2.3-1.jar:/usr/local/hbase/bin/../lib/jersey-core-1.8.jar:/usr/local/hbase/bin/../lib/jersey-json-1.8.jar:/usr/local/hbase/bin/../lib/jersey-server-1.8.jar:/usr/local/hbase/bin/../lib/jettison-1.3.1.jar:/usr/local/hbase/bin/../lib/jetty-6.1.26.jar:/usr/local/hbase/bin/../lib/jetty-sslengine-6.1.26.jar:/usr/local/hbase/bin/../lib/jetty-util-6.1.26.jar:/usr/local/hbase/bin/../lib/jruby-complete-1.6.8.jar:/usr/local/hbase/bin/../lib/jsp-2.1-6.1.14.jar:/usr/local/hbase/bin/../lib/jsp-api-2.1-6.1.14.jar:/usr/local/hbase/bin/../lib/jsr305-1.3.9.jar:/usr/local/hbase/bin/../lib/junit-4.11.jar:/usr/local/hbase/bin/../lib/libthrift-0.9.0.jar:/usr/local/hbase/bin/../lib/log4j-1.2.17.jar:/usr/local/hbase/bin/../lib/metrics-core-2.1.2.jar:/usr/local/hbase/bin/../lib/netty-3.6.6.Final.jar:/usr/local/hbase/bin/../lib/protobuf-java-2.5.0.jar:/usr/local/hbase/bin/../lib/servlet-api-2.5-6.1.14.jar:/usr/local/hbase/bin/../lib/slf4j-api-1.6.4.jar:/usr/local/hbase/bin/../lib/slf4j-log4j12-1.6.4.jar:/usr/local/hbase/bin/../lib/stax-api-1.0.1.jar:/usr/local/hbase/bin/../lib/xmlenc-0.52.jar:/usr/local/hbase/bin/../lib/zookeeper-3.4.5.jar:
2017-01-18 10:57:49,714 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.library.path=/usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2017-01-18 10:57:49,714 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.io.tmpdir=/tmp
2017-01-18 10:57:49,714 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.compiler=<NA>
2017-01-18 10:57:49,714 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:os.name=Linux
2017-01-18 10:57:49,714 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:os.arch=amd64
2017-01-18 10:57:49,714 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:os.version=4.4.0-53-generic
2017-01-18 10:57:49,714 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:user.name=ubuntu
2017-01-18 10:57:49,714 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:user.home=/home/ubuntu
2017-01-18 10:57:49,715 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:user.dir=/usr/local/hbase
2017-01-18 10:57:49,716 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 90000 datadir /home/ubuntu/zookeeper/version-2 snapdir /home/ubuntu/zookeeper/version-2
2017-01-18 10:57:49,717 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: FOLLOWING - LEADER ELECTION TOOK - 249
2017-01-18 10:57:49,732 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Getting a diff from the leader 0x0
2017-01-18 10:57:49,736 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileTxnSnapLog: Snapshotting: 0x0 to /home/ubuntu/zookeeper/version-2/snapshot.0
2017-01-18 10:57:49,740 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileTxnSnapLog: Snapshotting: 0x0 to /home/ubuntu/zookeeper/version-2/snapshot.0
2017-01-18 10:57:51,973 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Got zxid 0x100000001 expected 0x1
2017-01-18 10:57:51,973 INFO  [SyncThread:0] persistence.FileTxnLog: Creating new log file: log.100000001
2017-01-18 10:57:53,655 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.149:37718
2017-01-18 10:57:53,777 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to establish new session at /172.24.43.149:37718
2017-01-18 10:57:53,782 INFO  [CommitProcessor:0] server.ZooKeeperServer: Established session 0x59b139c2a80000 with negotiated timeout 90000 for client /172.24.43.149:37718
2017-01-18 10:57:54,447 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.150:40206
2017-01-18 10:57:54,447 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to establish new session at /172.24.43.150:40206
2017-01-18 10:57:54,449 INFO  [CommitProcessor:0] server.ZooKeeperServer: Established session 0x59b139c2a80001 with negotiated timeout 90000 for client /172.24.43.150:40206
2017-01-18 12:47:44,152 WARN  [RecvWorker:5] quorum.QuorumCnxManager: Connection broken for id 5, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 12:47:44,153 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Exception when following the leader
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)
	at org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:83)
	at org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:108)
	at org.apache.zookeeper.server.quorum.Learner.readPacket(Learner.java:152)
	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:85)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:740)
2017-01-18 12:47:44,155 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: shutdown called
java.lang.Exception: shutdown Follower
	at org.apache.zookeeper.server.quorum.Follower.shutdown(Follower.java:166)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:744)
2017-01-18 12:47:44,161 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.149:37718 which had sessionid 0x59b139c2a80000
2017-01-18 12:47:44,154 WARN  [RecvWorker:5] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 12:47:44,163 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.150:40206 which had sessionid 0x59b139c2a80001
2017-01-18 12:47:44,164 WARN  [SendWorker:5] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 12:47:44,166 WARN  [SendWorker:5] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 12:47:44,168 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 1 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 12:47:44,170 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 4 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 12:47:44,171 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 3 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 12:47:44,171 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 12:47:44,172 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FollowerZooKeeperServer: Shutting down
2017-01-18 12:47:44,172 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: shutting down
2017-01-18 12:47:44,172 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FollowerRequestProcessor: Shutting down
2017-01-18 12:47:44,172 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.CommitProcessor: Shutting down
2017-01-18 12:47:44,172 INFO  [FollowerRequestProcessor:0] quorum.FollowerRequestProcessor: FollowerRequestProcessor exited loop!
2017-01-18 12:47:44,172 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Ignoring unexpected runtime exception
java.nio.channels.CancelledKeyException
	at sun.nio.ch.SelectionKeyImpl.ensureValid(SelectionKeyImpl.java:73)
	at sun.nio.ch.SelectionKeyImpl.readyOps(SelectionKeyImpl.java:87)
	at org.apache.zookeeper.server.NIOServerCnxnFactory.run(NIOServerCnxnFactory.java:187)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 12:47:44,172 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.FinalRequestProcessor: shutdown of request processor complete
2017-01-18 12:47:44,172 INFO  [CommitProcessor:0] quorum.CommitProcessor: CommitProcessor exited loop!
2017-01-18 12:47:44,174 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.SyncRequestProcessor: Shutting down
2017-01-18 12:47:44,174 INFO  [SyncThread:0] server.SyncRequestProcessor: SyncRequestProcessor exited!
2017-01-18 12:47:44,175 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: LOOKING
2017-01-18 12:47:44,177 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileSnap: Reading snapshot /home/ubuntu/zookeeper/version-2/snapshot.0
2017-01-18 12:47:44,178 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 3 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:44,183 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 2 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:44,185 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 2 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:44,190 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: New election. My id =  0, proposed zxid=0x100000050
2017-01-18 12:47:44,190 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:44,191 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 12:47:44,192 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:44,193 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 12:47:44,323 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.150:41900
2017-01-18 12:47:44,324 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 12:47:44,325 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.150:41900 (no session established for client)
2017-01-18 12:47:44,394 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:44,395 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), FOLLOWING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:44,397 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: Notification time out: 400
2017-01-18 12:47:44,397 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), FOLLOWING (n.state), 2 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:44,397 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), FOLLOWING (n.state), 3 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:44,397 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 12:47:44,401 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LEADING (n.state), 4 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:44,401 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: FOLLOWING
2017-01-18 12:47:44,401 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 90000 datadir /home/ubuntu/zookeeper/version-2 snapdir /home/ubuntu/zookeeper/version-2
2017-01-18 12:47:44,402 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: FOLLOWING - LEADER ELECTION TOOK - 226
2017-01-18 12:47:44,557 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:54502
2017-01-18 12:47:44,560 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 12:47:44,560 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.157:54502 (no session established for client)
2017-01-18 12:47:44,745 WARN  [RecvWorker:4] quorum.QuorumCnxManager: Connection broken for id 4, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 12:47:44,745 WARN  [RecvWorker:4] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 12:47:44,745 WARN  [SendWorker:4] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 12:47:44,746 WARN  [SendWorker:4] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 12:47:44,750 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Exception when following the leader
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)
	at org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:83)
	at org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:108)
	at org.apache.zookeeper.server.quorum.Learner.readPacket(Learner.java:152)
	at org.apache.zookeeper.server.quorum.Learner.registerWithLeader(Learner.java:272)
	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:72)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:740)
2017-01-18 12:47:44,751 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: shutdown called
java.lang.Exception: shutdown Follower
	at org.apache.zookeeper.server.quorum.Follower.shutdown(Follower.java:166)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:744)
2017-01-18 12:47:44,752 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FollowerZooKeeperServer: Shutting down
2017-01-18 12:47:44,752 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: shutting down
2017-01-18 12:47:44,752 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: LOOKING
2017-01-18 12:47:44,753 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileSnap: Reading snapshot /home/ubuntu/zookeeper/version-2/snapshot.0
2017-01-18 12:47:44,789 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: New election. My id =  0, proposed zxid=0x100000050
2017-01-18 12:47:44,789 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x100000050 (n.zxid), 0x3 (n.round), LOOKING (n.state), 0 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:44,790 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), FOLLOWING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:44,790 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), FOLLOWING (n.state), 2 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:44,790 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), FOLLOWING (n.state), 3 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:44,791 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 4 at election address sue-data-3/172.24.43.150:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 12:47:44,792 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 12:47:44,992 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x100000050 (n.zxid), 0x3 (n.round), LOOKING (n.state), 0 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:44,993 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), FOLLOWING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:44,993 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), FOLLOWING (n.state), 3 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:44,994 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), FOLLOWING (n.state), 2 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:44,994 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 4 at election address sue-data-3/172.24.43.150:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 12:47:44,995 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: Notification time out: 400
2017-01-18 12:47:44,995 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 12:47:45,206 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:54510
2017-01-18 12:47:45,206 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 12:47:45,206 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.157:54510 (no session established for client)
2017-01-18 12:47:45,338 WARN  [RecvWorker:3] quorum.QuorumCnxManager: Connection broken for id 3, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 12:47:45,338 WARN  [RecvWorker:3] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 12:47:45,339 WARN  [SendWorker:3] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 12:47:45,339 WARN  [SendWorker:3] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 12:47:45,395 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x100000050 (n.zxid), 0x3 (n.round), LOOKING (n.state), 0 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:45,396 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 3 at election address sue-data-2/172.24.43.151:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 12:47:45,397 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), FOLLOWING (n.state), 2 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:45,397 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), FOLLOWING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:45,398 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: Notification time out: 800
2017-01-18 12:47:45,398 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 4 at election address sue-data-3/172.24.43.150:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 12:47:45,399 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 12:47:45,557 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.148:32862
2017-01-18 12:47:45,558 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 12:47:45,558 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.148:32862 (no session established for client)
2017-01-18 12:47:45,646 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.148:32864
2017-01-18 12:47:45,646 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 12:47:45,646 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.148:32864 (no session established for client)
2017-01-18 12:47:46,094 WARN  [RecvWorker:2] quorum.QuorumCnxManager: Connection broken for id 2, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 12:47:46,094 WARN  [RecvWorker:2] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 12:47:46,095 WARN  [SendWorker:2] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 12:47:46,095 WARN  [SendWorker:2] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 12:47:46,198 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x100000050 (n.zxid), 0x3 (n.round), LOOKING (n.state), 0 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:46,199 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: Notification time out: 1600
2017-01-18 12:47:46,199 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), FOLLOWING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:47:46,199 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 2 at election address sue-data-1/172.24.43.148:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 12:47:46,200 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 3 at election address sue-data-2/172.24.43.151:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 12:47:46,201 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 4 at election address sue-data-3/172.24.43.150:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 12:47:46,202 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 12:47:46,661 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.156:55240
2017-01-18 12:47:46,662 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 12:47:46,662 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.156:55240 (no session established for client)
2017-01-18 12:47:46,713 WARN  [RecvWorker:1] quorum.QuorumCnxManager: Connection broken for id 1, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 12:47:46,713 WARN  [RecvWorker:1] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 12:47:46,713 WARN  [SendWorker:1] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 12:47:46,714 WARN  [SendWorker:1] quorum.QuorumCnxManager: Send worker leaving thread
Wed Jan 18 12:48:13 UTC 2017 Starting zookeeper on sue-master-1
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 514644
max locked memory       (kbytes, -l) 64
max memory size         (kbytes, -m) unlimited
open files                      (-n) 1024
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) unlimited
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited
2017-01-18 12:48:13,618 WARN  [main] quorum.QuorumPeerConfig: Non-optimial configuration, consider an odd number of servers.
2017-01-18 12:48:13,618 INFO  [main] quorum.QuorumPeerConfig: Defaulting to majority quorums
2017-01-18 12:48:13,700 DEBUG [main] util.Bytes: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.util.Bytes
2017-01-18 12:48:13,701 DEBUG [main] util.VersionInfo: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.util.VersionInfo
2017-01-18 12:48:13,702 DEBUG [main] zookeeper.ZKConfig: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.zookeeper.ZKConfig
2017-01-18 12:48:13,702 DEBUG [main] hbase.HBaseConfiguration: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.HBaseConfiguration
2017-01-18 12:48:13,702 DEBUG [main] hadoop.hbase: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase
2017-01-18 12:48:13,702 INFO  [main] quorum.QuorumPeerMain: Starting quorum peer
2017-01-18 12:48:13,727 INFO  [main] server.NIOServerCnxnFactory: binding to port 0.0.0.0/0.0.0.0:2181
2017-01-18 12:48:13,749 INFO  [main] quorum.QuorumPeer: tickTime set to 3000
2017-01-18 12:48:13,749 INFO  [main] quorum.QuorumPeer: minSessionTimeout set to -1
2017-01-18 12:48:13,750 INFO  [main] quorum.QuorumPeer: maxSessionTimeout set to 90000
2017-01-18 12:48:13,750 INFO  [main] quorum.QuorumPeer: initLimit set to 10
2017-01-18 12:48:13,781 INFO  [main] quorum.QuorumPeer: currentEpoch not found! Creating with a reasonable default of 0. This should only happen when you are upgrading your installation
2017-01-18 12:48:13,785 INFO  [main] quorum.QuorumPeer: acceptedEpoch not found! Creating with a reasonable default of 0. This should only happen when you are upgrading your installation
2017-01-18 12:48:13,790 INFO  [Thread-1] quorum.QuorumCnxManager: My election bind port: 0.0.0.0/0.0.0.0:3888
2017-01-18 12:48:13,796 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.148:38754
2017-01-18 12:48:13,802 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 2 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:48:13,812 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: LOOKING
2017-01-18 12:48:13,813 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: New election. My id =  0, proposed zxid=0x0
2017-01-18 12:48:13,814 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 0 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:48:13,816 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (1, 0)
2017-01-18 12:48:13,817 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (3, 0)
2017-01-18 12:48:13,817 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (4, 0)
2017-01-18 12:48:13,818 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.157:37156
2017-01-18 12:48:13,818 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (5, 0)
2017-01-18 12:48:13,819 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.151:49084
2017-01-18 12:48:13,819 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 0 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:48:13,820 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.150:56740
2017-01-18 12:48:13,820 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 1 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:48:13,821 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.149:58142
2017-01-18 12:48:13,822 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 3 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:48:13,823 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 4 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:48:13,824 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 5 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:48:14,025 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: FOLLOWING
2017-01-18 12:48:14,031 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: TCP NoDelay set to: true
2017-01-18 12:48:14,046 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:zookeeper.version=3.4.5--1, built on 10/05/2013 16:05 GMT
2017-01-18 12:48:14,046 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:host.name=sue-master-1
2017-01-18 12:48:14,047 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.version=1.8.0_111
2017-01-18 12:48:14,047 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.vendor=Oracle Corporation
2017-01-18 12:48:14,047 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.home=/usr/lib/jvm/java-8-openjdk-amd64/jre
2017-01-18 12:48:14,048 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.class.path=/usr/local/hbase/bin/../conf:/usr/lib/jvm/java-8-openjdk-amd64/jre//lib/tools.jar:/usr/local/hbase/bin/..:/usr/local/hbase/bin/../lib/activation-1.1.jar:/usr/local/hbase/bin/../lib/asm-3.1.jar:/usr/local/hbase/bin/../lib/commons-beanutils-1.7.0.jar:/usr/local/hbase/bin/../lib/commons-beanutils-core-1.8.0.jar:/usr/local/hbase/bin/../lib/commons-cli-1.2.jar:/usr/local/hbase/bin/../lib/commons-codec-1.7.jar:/usr/local/hbase/bin/../lib/commons-collections-3.2.1.jar:/usr/local/hbase/bin/../lib/commons-configuration-1.6.jar:/usr/local/hbase/bin/../lib/commons-digester-1.8.jar:/usr/local/hbase/bin/../lib/commons-el-1.0.jar:/usr/local/hbase/bin/../lib/commons-httpclient-3.1.jar:/usr/local/hbase/bin/../lib/commons-io-2.4.jar:/usr/local/hbase/bin/../lib/commons-lang-2.6.jar:/usr/local/hbase/bin/../lib/commons-logging-1.1.1.jar:/usr/local/hbase/bin/../lib/commons-math-2.2.jar:/usr/local/hbase/bin/../lib/commons-net-1.4.1.jar:/usr/local/hbase/bin/../lib/core-3.1.1.jar:/usr/local/hbase/bin/../lib/findbugs-annotations-1.3.9-1.jar:/usr/local/hbase/bin/../lib/guava-12.0.1.jar:/usr/local/hbase/bin/../lib/hadoop-core-1.2.1.jar:/usr/local/hbase/bin/../lib/hamcrest-core-1.3.jar:/usr/local/hbase/bin/../lib/hbase-client-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-common-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-common-0.98.0-hadoop1-tests.jar:/usr/local/hbase/bin/../lib/hbase-examples-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-hadoop1-compat-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-hadoop-compat-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-it-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-it-0.98.0-hadoop1-tests.jar:/usr/local/hbase/bin/../lib/hbase-prefix-tree-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-protocol-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-server-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-server-0.98.0-hadoop1-tests.jar:/usr/local/hbase/bin/../lib/hbase-shell-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-testing-util-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-thrift-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/high-scale-lib-1.1.1.jar:/usr/local/hbase/bin/../lib/htrace-core-2.04.jar:/usr/local/hbase/bin/../lib/httpclient-4.1.3.jar:/usr/local/hbase/bin/../lib/httpcore-4.1.3.jar:/usr/local/hbase/bin/../lib/jackson-core-asl-1.8.8.jar:/usr/local/hbase/bin/../lib/jackson-jaxrs-1.8.8.jar:/usr/local/hbase/bin/../lib/jackson-mapper-asl-1.8.8.jar:/usr/local/hbase/bin/../lib/jackson-xc-1.8.8.jar:/usr/local/hbase/bin/../lib/jamon-runtime-2.3.1.jar:/usr/local/hbase/bin/../lib/jasper-compiler-5.5.23.jar:/usr/local/hbase/bin/../lib/jasper-runtime-5.5.23.jar:/usr/local/hbase/bin/../lib/jaxb-api-2.2.2.jar:/usr/local/hbase/bin/../lib/jaxb-impl-2.2.3-1.jar:/usr/local/hbase/bin/../lib/jersey-core-1.8.jar:/usr/local/hbase/bin/../lib/jersey-json-1.8.jar:/usr/local/hbase/bin/../lib/jersey-server-1.8.jar:/usr/local/hbase/bin/../lib/jettison-1.3.1.jar:/usr/local/hbase/bin/../lib/jetty-6.1.26.jar:/usr/local/hbase/bin/../lib/jetty-sslengine-6.1.26.jar:/usr/local/hbase/bin/../lib/jetty-util-6.1.26.jar:/usr/local/hbase/bin/../lib/jruby-complete-1.6.8.jar:/usr/local/hbase/bin/../lib/jsp-2.1-6.1.14.jar:/usr/local/hbase/bin/../lib/jsp-api-2.1-6.1.14.jar:/usr/local/hbase/bin/../lib/jsr305-1.3.9.jar:/usr/local/hbase/bin/../lib/junit-4.11.jar:/usr/local/hbase/bin/../lib/libthrift-0.9.0.jar:/usr/local/hbase/bin/../lib/log4j-1.2.17.jar:/usr/local/hbase/bin/../lib/metrics-core-2.1.2.jar:/usr/local/hbase/bin/../lib/netty-3.6.6.Final.jar:/usr/local/hbase/bin/../lib/protobuf-java-2.5.0.jar:/usr/local/hbase/bin/../lib/servlet-api-2.5-6.1.14.jar:/usr/local/hbase/bin/../lib/slf4j-api-1.6.4.jar:/usr/local/hbase/bin/../lib/slf4j-log4j12-1.6.4.jar:/usr/local/hbase/bin/../lib/stax-api-1.0.1.jar:/usr/local/hbase/bin/../lib/xmlenc-0.52.jar:/usr/local/hbase/bin/../lib/zookeeper-3.4.5.jar:
2017-01-18 12:48:14,048 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.library.path=/usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2017-01-18 12:48:14,048 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.io.tmpdir=/tmp
2017-01-18 12:48:14,049 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.compiler=<NA>
2017-01-18 12:48:14,049 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:os.name=Linux
2017-01-18 12:48:14,049 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:os.arch=amd64
2017-01-18 12:48:14,049 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:os.version=4.4.0-53-generic
2017-01-18 12:48:14,049 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:user.name=ubuntu
2017-01-18 12:48:14,049 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:user.home=/home/ubuntu
2017-01-18 12:48:14,049 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:user.dir=/usr/local/hbase
2017-01-18 12:48:14,051 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 90000 datadir /home/ubuntu/zookeeper/version-2 snapdir /home/ubuntu/zookeeper/version-2
2017-01-18 12:48:14,053 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: FOLLOWING - LEADER ELECTION TOOK - 240
2017-01-18 12:48:14,083 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Getting a diff from the leader 0x0
2017-01-18 12:48:14,087 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileTxnSnapLog: Snapshotting: 0x0 to /home/ubuntu/zookeeper/version-2/snapshot.0
2017-01-18 12:48:14,091 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileTxnSnapLog: Snapshotting: 0x0 to /home/ubuntu/zookeeper/version-2/snapshot.0
2017-01-18 12:48:16,299 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Got zxid 0x100000001 expected 0x1
2017-01-18 12:48:16,299 INFO  [SyncThread:0] persistence.FileTxnLog: Creating new log file: log.100000001
2017-01-18 12:48:18,069 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.156:55302
2017-01-18 12:48:18,162 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to establish new session at /172.24.43.156:55302
2017-01-18 12:48:18,169 INFO  [CommitProcessor:0] server.ZooKeeperServer: Established session 0x59b19ed7070000 with negotiated timeout 90000 for client /172.24.43.156:55302
2017-01-18 12:50:00,473 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Exception when following the leader
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:63)
	at org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:83)
	at org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:108)
	at org.apache.zookeeper.server.quorum.Learner.readPacket(Learner.java:152)
	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:85)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:740)
2017-01-18 12:50:00,476 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: shutdown called
java.lang.Exception: shutdown Follower
	at org.apache.zookeeper.server.quorum.Follower.shutdown(Follower.java:166)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:744)
2017-01-18 12:50:00,478 WARN  [RecvWorker:5] quorum.QuorumCnxManager: Connection broken for id 5, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 12:50:00,478 WARN  [RecvWorker:5] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 12:50:00,478 WARN  [SendWorker:5] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 12:50:00,479 WARN  [SendWorker:5] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 12:50:00,480 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.156:55302 which had sessionid 0x59b19ed7070000
2017-01-18 12:50:00,488 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FollowerZooKeeperServer: Shutting down
2017-01-18 12:50:00,488 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: shutting down
2017-01-18 12:50:00,488 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FollowerRequestProcessor: Shutting down
2017-01-18 12:50:00,488 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.CommitProcessor: Shutting down
2017-01-18 12:50:00,488 INFO  [FollowerRequestProcessor:0] quorum.FollowerRequestProcessor: FollowerRequestProcessor exited loop!
2017-01-18 12:50:00,489 INFO  [CommitProcessor:0] quorum.CommitProcessor: CommitProcessor exited loop!
2017-01-18 12:50:00,489 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.FinalRequestProcessor: shutdown of request processor complete
2017-01-18 12:50:00,493 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 3 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 12:50:00,495 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 4 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-18 12:50:00,496 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.SyncRequestProcessor: Shutting down
2017-01-18 12:50:00,496 INFO  [SyncThread:0] server.SyncRequestProcessor: SyncRequestProcessor exited!
2017-01-18 12:50:00,496 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: LOOKING
2017-01-18 12:50:00,498 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 3 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:50:00,498 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 1 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:50:00,498 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 3 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:50:00,499 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileSnap: Reading snapshot /home/ubuntu/zookeeper/version-2/snapshot.0
2017-01-18 12:50:00,499 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 1 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:50:00,509 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: New election. My id =  0, proposed zxid=0x100000050
2017-01-18 12:50:00,511 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 12:50:00,512 WARN  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Cannot open channel to 5 at election address sue-data-4/172.24.43.149:3888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.connectOne(QuorumCnxManager.java:354)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.toSend(QuorumCnxManager.java:327)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.process(FastLeaderElection.java:393)
	at org.apache.zookeeper.server.quorum.FastLeaderElection$Messenger$WorkerSender.run(FastLeaderElection.java:365)
	at java.lang.Thread.run(Thread.java:745)
2017-01-18 12:50:00,516 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:50:00,516 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 0 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:50:00,516 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 2 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 2 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:50:00,518 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x100000050 (n.zxid), 0x2 (n.round), LOOKING (n.state), 2 (n.sid), 0x1 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:50:00,718 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: FOLLOWING
2017-01-18 12:50:00,718 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 90000 datadir /home/ubuntu/zookeeper/version-2 snapdir /home/ubuntu/zookeeper/version-2
2017-01-18 12:50:00,718 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: FOLLOWING - LEADER ELECTION TOOK - 221
2017-01-18 12:50:00,720 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Unexpected exception, tries=0, connecting to sue-data-3/172.24.43.150:2888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.Learner.connectToLeader(Learner.java:224)
	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:71)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:740)
2017-01-18 12:50:01,027 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:54674
2017-01-18 12:50:01,027 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 12:50:01,027 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.157:54674 (no session established for client)
2017-01-18 12:50:01,148 WARN  [RecvWorker:4] quorum.QuorumCnxManager: Connection broken for id 4, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 12:50:01,148 WARN  [RecvWorker:4] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 12:50:01,149 WARN  [SendWorker:4] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 12:50:01,149 WARN  [SendWorker:4] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 12:50:01,149 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:54676
2017-01-18 12:50:01,155 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 12:50:01,155 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.157:54676 (no session established for client)
2017-01-18 12:50:01,237 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.148:32936
2017-01-18 12:50:01,238 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 12:50:01,238 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.148:32936 (no session established for client)
2017-01-18 12:50:01,501 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.151:58842
2017-01-18 12:50:01,502 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 12:50:01,502 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.151:58842 (no session established for client)
2017-01-18 12:50:01,553 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.150:41990
2017-01-18 12:50:01,555 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 12:50:01,555 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.150:41990 (no session established for client)
2017-01-18 12:50:01,647 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.151:58846
2017-01-18 12:50:01,647 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 12:50:01,648 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.151:58846 (no session established for client)
2017-01-18 12:50:01,713 WARN  [RecvWorker:3] quorum.QuorumCnxManager: Connection broken for id 3, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 12:50:01,714 WARN  [RecvWorker:3] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 12:50:01,714 WARN  [SendWorker:3] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 12:50:01,714 WARN  [SendWorker:3] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 12:50:01,722 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Unexpected exception, tries=1, connecting to sue-data-3/172.24.43.150:2888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.Learner.connectToLeader(Learner.java:224)
	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:71)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:740)
2017-01-18 12:50:02,151 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.148:32948
2017-01-18 12:50:02,153 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 12:50:02,153 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.148:32948 (no session established for client)
2017-01-18 12:50:02,227 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:54688
2017-01-18 12:50:02,228 WARN  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running
2017-01-18 12:50:02,228 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.157:54688 (no session established for client)
2017-01-18 12:50:02,350 WARN  [RecvWorker:2] quorum.QuorumCnxManager: Connection broken for id 2, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 12:50:02,350 WARN  [RecvWorker:2] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 12:50:02,350 WARN  [SendWorker:2] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 12:50:02,351 WARN  [SendWorker:2] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 12:50:02,723 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Unexpected exception, tries=2, connecting to sue-data-3/172.24.43.150:2888
java.net.ConnectException: Connection refused (Connection refused)
	at java.net.PlainSocketImpl.socketConnect(Native Method)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at org.apache.zookeeper.server.quorum.Learner.connectToLeader(Learner.java:224)
	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:71)
	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:740)
2017-01-18 12:50:02,930 WARN  [RecvWorker:1] quorum.QuorumCnxManager: Connection broken for id 1, my id = 0, error = 
java.io.EOFException
	at java.io.DataInputStream.readInt(DataInputStream.java:392)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$RecvWorker.run(QuorumCnxManager.java:747)
2017-01-18 12:50:02,931 WARN  [RecvWorker:1] quorum.QuorumCnxManager: Interrupting SendWorker
2017-01-18 12:50:02,931 WARN  [SendWorker:1] quorum.QuorumCnxManager: Interrupted while waiting for message on queue
java.lang.InterruptedException
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.reportInterruptAfterWait(AbstractQueuedSynchronizer.java:2014)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2088)
	at java.util.concurrent.ArrayBlockingQueue.poll(ArrayBlockingQueue.java:418)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.pollSendQueue(QuorumCnxManager.java:831)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager.access$500(QuorumCnxManager.java:62)
	at org.apache.zookeeper.server.quorum.QuorumCnxManager$SendWorker.run(QuorumCnxManager.java:667)
2017-01-18 12:50:02,931 WARN  [SendWorker:1] quorum.QuorumCnxManager: Send worker leaving thread
2017-01-18 12:50:03,486 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.157:54698
Wed Jan 18 12:50:28 UTC 2017 Starting zookeeper on sue-master-1
core file size          (blocks, -c) 0
data seg size           (kbytes, -d) unlimited
scheduling priority             (-e) 0
file size               (blocks, -f) unlimited
pending signals                 (-i) 514644
max locked memory       (kbytes, -l) 64
max memory size         (kbytes, -m) unlimited
open files                      (-n) 1024
pipe size            (512 bytes, -p) 8
POSIX message queues     (bytes, -q) 819200
real-time priority              (-r) 0
stack size              (kbytes, -s) 8192
cpu time               (seconds, -t) unlimited
max user processes              (-u) unlimited
virtual memory          (kbytes, -v) unlimited
file locks                      (-x) unlimited
2017-01-18 12:50:28,764 WARN  [main] quorum.QuorumPeerConfig: Non-optimial configuration, consider an odd number of servers.
2017-01-18 12:50:28,764 INFO  [main] quorum.QuorumPeerConfig: Defaulting to majority quorums
2017-01-18 12:50:28,859 DEBUG [main] util.Bytes: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.util.Bytes
2017-01-18 12:50:28,860 DEBUG [main] util.VersionInfo: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.util.VersionInfo
2017-01-18 12:50:28,860 DEBUG [main] zookeeper.ZKConfig: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.zookeeper.ZKConfig
2017-01-18 12:50:28,860 DEBUG [main] hbase.HBaseConfiguration: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase.HBaseConfiguration
2017-01-18 12:50:28,861 DEBUG [main] hadoop.hbase: preRegister called. Server=com.sun.jmx.mbeanserver.JmxMBeanServer@2be94b0f, name=log4j:logger=org.apache.hadoop.hbase
2017-01-18 12:50:28,861 INFO  [main] quorum.QuorumPeerMain: Starting quorum peer
2017-01-18 12:50:28,870 INFO  [main] server.NIOServerCnxnFactory: binding to port 0.0.0.0/0.0.0.0:2181
2017-01-18 12:50:28,882 INFO  [main] quorum.QuorumPeer: tickTime set to 3000
2017-01-18 12:50:28,882 INFO  [main] quorum.QuorumPeer: minSessionTimeout set to -1
2017-01-18 12:50:28,882 INFO  [main] quorum.QuorumPeer: maxSessionTimeout set to 90000
2017-01-18 12:50:28,882 INFO  [main] quorum.QuorumPeer: initLimit set to 10
2017-01-18 12:50:28,891 INFO  [main] quorum.QuorumPeer: currentEpoch not found! Creating with a reasonable default of 0. This should only happen when you are upgrading your installation
2017-01-18 12:50:28,893 INFO  [main] quorum.QuorumPeer: acceptedEpoch not found! Creating with a reasonable default of 0. This should only happen when you are upgrading your installation
2017-01-18 12:50:28,906 INFO  [Thread-1] quorum.QuorumCnxManager: My election bind port: 0.0.0.0/0.0.0.0:3888
2017-01-18 12:50:28,917 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: LOOKING
2017-01-18 12:50:28,918 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.FastLeaderElection: New election. My id =  0, proposed zxid=0x0
2017-01-18 12:50:28,919 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 0 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 0 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:50:28,922 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (1, 0)
2017-01-18 12:50:28,923 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (2, 0)
2017-01-18 12:50:28,923 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (3, 0)
2017-01-18 12:50:28,923 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.157:37310
2017-01-18 12:50:28,925 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (4, 0)
2017-01-18 12:50:28,926 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.151:49222
2017-01-18 12:50:28,926 INFO  [WorkerSender[myid=0]] quorum.QuorumCnxManager: Have smaller server identifier, so dropping the connection: (5, 0)
2017-01-18 12:50:28,927 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 1 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:50:28,927 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.148:38842
2017-01-18 12:50:28,928 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.150:56822
2017-01-18 12:50:28,928 INFO  [sue-master-1/172.24.43.156:3888] quorum.QuorumCnxManager: Received connection request /172.24.43.149:58206
2017-01-18 12:50:28,930 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 3 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:50:28,930 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 4 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:50:28,930 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 2 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:50:28,931 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 0 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:50:28,931 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 5 (n.leader), 0x0 (n.zxid), 0x1 (n.round), LOOKING (n.state), 5 (n.sid), 0x0 (n.peerEPoch), LOOKING (my state)
2017-01-18 12:50:29,131 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.QuorumPeer: FOLLOWING
2017-01-18 12:50:29,138 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: TCP NoDelay set to: true
2017-01-18 12:50:29,147 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:zookeeper.version=3.4.5--1, built on 10/05/2013 16:05 GMT
2017-01-18 12:50:29,147 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:host.name=sue-master-1
2017-01-18 12:50:29,147 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.version=1.8.0_111
2017-01-18 12:50:29,147 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.vendor=Oracle Corporation
2017-01-18 12:50:29,147 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.home=/usr/lib/jvm/java-8-openjdk-amd64/jre
2017-01-18 12:50:29,147 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.class.path=/usr/local/hbase/bin/../conf:/usr/lib/jvm/java-8-openjdk-amd64/jre//lib/tools.jar:/usr/local/hbase/bin/..:/usr/local/hbase/bin/../lib/activation-1.1.jar:/usr/local/hbase/bin/../lib/asm-3.1.jar:/usr/local/hbase/bin/../lib/commons-beanutils-1.7.0.jar:/usr/local/hbase/bin/../lib/commons-beanutils-core-1.8.0.jar:/usr/local/hbase/bin/../lib/commons-cli-1.2.jar:/usr/local/hbase/bin/../lib/commons-codec-1.7.jar:/usr/local/hbase/bin/../lib/commons-collections-3.2.1.jar:/usr/local/hbase/bin/../lib/commons-configuration-1.6.jar:/usr/local/hbase/bin/../lib/commons-digester-1.8.jar:/usr/local/hbase/bin/../lib/commons-el-1.0.jar:/usr/local/hbase/bin/../lib/commons-httpclient-3.1.jar:/usr/local/hbase/bin/../lib/commons-io-2.4.jar:/usr/local/hbase/bin/../lib/commons-lang-2.6.jar:/usr/local/hbase/bin/../lib/commons-logging-1.1.1.jar:/usr/local/hbase/bin/../lib/commons-math-2.2.jar:/usr/local/hbase/bin/../lib/commons-net-1.4.1.jar:/usr/local/hbase/bin/../lib/core-3.1.1.jar:/usr/local/hbase/bin/../lib/findbugs-annotations-1.3.9-1.jar:/usr/local/hbase/bin/../lib/guava-12.0.1.jar:/usr/local/hbase/bin/../lib/hadoop-core-1.2.1.jar:/usr/local/hbase/bin/../lib/hamcrest-core-1.3.jar:/usr/local/hbase/bin/../lib/hbase-client-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-common-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-common-0.98.0-hadoop1-tests.jar:/usr/local/hbase/bin/../lib/hbase-examples-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-hadoop1-compat-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-hadoop-compat-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-it-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-it-0.98.0-hadoop1-tests.jar:/usr/local/hbase/bin/../lib/hbase-prefix-tree-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-protocol-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-server-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-server-0.98.0-hadoop1-tests.jar:/usr/local/hbase/bin/../lib/hbase-shell-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-testing-util-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/hbase-thrift-0.98.0-hadoop1.jar:/usr/local/hbase/bin/../lib/high-scale-lib-1.1.1.jar:/usr/local/hbase/bin/../lib/htrace-core-2.04.jar:/usr/local/hbase/bin/../lib/httpclient-4.1.3.jar:/usr/local/hbase/bin/../lib/httpcore-4.1.3.jar:/usr/local/hbase/bin/../lib/jackson-core-asl-1.8.8.jar:/usr/local/hbase/bin/../lib/jackson-jaxrs-1.8.8.jar:/usr/local/hbase/bin/../lib/jackson-mapper-asl-1.8.8.jar:/usr/local/hbase/bin/../lib/jackson-xc-1.8.8.jar:/usr/local/hbase/bin/../lib/jamon-runtime-2.3.1.jar:/usr/local/hbase/bin/../lib/jasper-compiler-5.5.23.jar:/usr/local/hbase/bin/../lib/jasper-runtime-5.5.23.jar:/usr/local/hbase/bin/../lib/jaxb-api-2.2.2.jar:/usr/local/hbase/bin/../lib/jaxb-impl-2.2.3-1.jar:/usr/local/hbase/bin/../lib/jersey-core-1.8.jar:/usr/local/hbase/bin/../lib/jersey-json-1.8.jar:/usr/local/hbase/bin/../lib/jersey-server-1.8.jar:/usr/local/hbase/bin/../lib/jettison-1.3.1.jar:/usr/local/hbase/bin/../lib/jetty-6.1.26.jar:/usr/local/hbase/bin/../lib/jetty-sslengine-6.1.26.jar:/usr/local/hbase/bin/../lib/jetty-util-6.1.26.jar:/usr/local/hbase/bin/../lib/jruby-complete-1.6.8.jar:/usr/local/hbase/bin/../lib/jsp-2.1-6.1.14.jar:/usr/local/hbase/bin/../lib/jsp-api-2.1-6.1.14.jar:/usr/local/hbase/bin/../lib/jsr305-1.3.9.jar:/usr/local/hbase/bin/../lib/junit-4.11.jar:/usr/local/hbase/bin/../lib/libthrift-0.9.0.jar:/usr/local/hbase/bin/../lib/log4j-1.2.17.jar:/usr/local/hbase/bin/../lib/metrics-core-2.1.2.jar:/usr/local/hbase/bin/../lib/netty-3.6.6.Final.jar:/usr/local/hbase/bin/../lib/protobuf-java-2.5.0.jar:/usr/local/hbase/bin/../lib/servlet-api-2.5-6.1.14.jar:/usr/local/hbase/bin/../lib/slf4j-api-1.6.4.jar:/usr/local/hbase/bin/../lib/slf4j-log4j12-1.6.4.jar:/usr/local/hbase/bin/../lib/stax-api-1.0.1.jar:/usr/local/hbase/bin/../lib/xmlenc-0.52.jar:/usr/local/hbase/bin/../lib/zookeeper-3.4.5.jar:
2017-01-18 12:50:29,148 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.library.path=/usr/java/packages/lib/amd64:/usr/lib/x86_64-linux-gnu/jni:/lib/x86_64-linux-gnu:/usr/lib/x86_64-linux-gnu:/usr/lib/jni:/lib:/usr/lib
2017-01-18 12:50:29,148 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.io.tmpdir=/tmp
2017-01-18 12:50:29,148 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:java.compiler=<NA>
2017-01-18 12:50:29,148 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:os.name=Linux
2017-01-18 12:50:29,148 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:os.arch=amd64
2017-01-18 12:50:29,148 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:os.version=4.4.0-53-generic
2017-01-18 12:50:29,148 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:user.name=ubuntu
2017-01-18 12:50:29,148 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:user.home=/home/ubuntu
2017-01-18 12:50:29,148 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Server environment:user.dir=/usr/local/hbase
2017-01-18 12:50:29,150 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Created server with tickTime 3000 minSessionTimeout 6000 maxSessionTimeout 90000 datadir /home/ubuntu/zookeeper/version-2 snapdir /home/ubuntu/zookeeper/version-2
2017-01-18 12:50:29,151 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: FOLLOWING - LEADER ELECTION TOOK - 232
2017-01-18 12:50:29,189 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Getting a diff from the leader 0x0
2017-01-18 12:50:29,193 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileTxnSnapLog: Snapshotting: 0x0 to /home/ubuntu/zookeeper/version-2/snapshot.0
2017-01-18 12:50:29,197 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] persistence.FileTxnSnapLog: Snapshotting: 0x0 to /home/ubuntu/zookeeper/version-2/snapshot.0
2017-01-18 12:50:30,606 WARN  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] quorum.Learner: Got zxid 0x100000001 expected 0x1
2017-01-18 12:50:30,606 INFO  [SyncThread:0] persistence.FileTxnLog: Creating new log file: log.100000001
2017-01-18 12:50:32,847 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.151:58922
2017-01-18 12:50:32,908 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to establish new session at /172.24.43.151:58922
2017-01-18 12:50:32,913 INFO  [CommitProcessor:0] server.ZooKeeperServer: Established session 0x59b1a0e6c90000 with negotiated timeout 90000 for client /172.24.43.151:58922
2017-01-18 12:50:33,240 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.149:39600
2017-01-18 12:50:33,240 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to establish new session at /172.24.43.149:39600
2017-01-18 12:50:33,242 INFO  [CommitProcessor:0] server.ZooKeeperServer: Established session 0x59b1a0e6c90001 with negotiated timeout 90000 for client /172.24.43.149:39600
2017-01-19 21:27:48,951 INFO  [WorkerReceiver[myid=0]] quorum.FastLeaderElection: Notification: 4 (n.leader), 0x10000005b (n.zxid), 0x2 (n.round), LOOKING (n.state), 4 (n.sid), 0x1 (n.peerEPoch), FOLLOWING (my state)
2017-01-19 21:27:49,948 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxnFactory: Accepted socket connection from /172.24.43.150:55610
2017-01-19 21:27:49,949 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.ZooKeeperServer: Client attempting to renew session 0x359b1a0e6c80000 at /172.24.43.150:55610
2017-01-19 21:27:49,949 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] quorum.Learner: Revalidating client: 0x359b1a0e6c80000
2017-01-19 21:27:49,951 INFO  [QuorumPeer[myid=0]/0:0:0:0:0:0:0:0:2181] server.ZooKeeperServer: Established session 0x359b1a0e6c80000 with negotiated timeout 90000 for client /172.24.43.150:55610
2017-01-19 21:27:50,012 INFO  [NIOServerCxn.Factory:0.0.0.0/0.0.0.0:2181] server.NIOServerCnxn: Closed socket connection for client /172.24.43.150:55610 which had sessionid 0x359b1a0e6c80000
